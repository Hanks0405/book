
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7.6 조건부기댓값과 예측 문제 &#8212; 데이터 사이언스 스쿨</title>
    
  <link rel="stylesheet" href="../_static/css/index.d431a4ee1c1efae0e38bdfebc22debff.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.bfb7730f9caf2ec0b46a44615585038c.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/.ipynb_checkpoints/myfile-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.30270b6e4c972e43c488.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "datascienceschool/book");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8장 사이파이로 공부하는 확률분포" href="08.00 8장 사이파이로 공부하는 확률분포.html" />
    <link rel="prev" title="7.5 공분산과 상관계수" href="07.05 공분산과 상관계수.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">데이터 사이언스 스쿨</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   데이터 사이언스 스쿨
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  파이썬 편
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/00.00 소개의 글.html">
   소개의 글
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/01.00 1장 파이썬 설치와 설정.html">
   1장 파이썬 설치와 설정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.00 2장 파이썬 기초 문법.html">
   2장 파이썬 기초문법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/03.00 3장 넘파이 배열 프로그래밍.html">
   3장 넘파이 배열 프로그래밍
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.00 4장 판다스 데이터 분석.html">
   4장 판다스 데이터 분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/05.00 5장 데이터 시각화.html">
   5장 데이터 시각화
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  수학 편
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="00.00 소개의 글.html">
   소개의 글
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.00 1장 수학 기호.html">
   1장 수학 기호
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.00 2장 넘파이(NumPy)로 공부하는 선형대수.html">
   2장 넘파이(NumPy)로 공부하는 선형대수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.00 3장 고급 선형대수.html">
   3장 고급 선형대수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.00 4장 심파이(SymPy)로 공부하는 미적분.html">
   4장 심파이(SymPy)로 공부하는 미적분
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.00 5장 사이파이(SciPy)로 공부하는 최적화.html">
   5장 사이파이(SciPy)로 공부하는 최적화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.00 6장 피지엠파이(pgmpy)로 공부하는 확률론.html">
   6장 피지엠파이(pgmpy)로 공부하는 확률론
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="07.00 7장 확률변수와 상관관계.html">
   7장 확률변수와 상관관계
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="07.01 확률적 데이터와 확률변수.html">
     7.1 확률적 데이터와 확률변수
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.02 기댓값과 확률변수의 변환.html">
     7.2 기댓값과 확률변수의 변환
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.03 분산과 표준편차.html">
     7.3 분산과 표준편차
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.04 다변수 확률변수.html">
     7.4 다변수 확률변수
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.05 공분산과 상관계수.html">
     7.5 공분산과 상관계수
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     7.6 조건부기댓값과 예측 문제
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08.00 8장 사이파이로 공부하는 확률분포.html">
   8장 사이파이로 공부하는 확률분포
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.00 9장 추정과 검정.html">
   9장 추정과 검정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10.00 10장 엔트로피.html">
   10장 엔트로피
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  머신러닝 편
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/01.01 데이터 분석의 소개.html">
   1.1 데이터 분석의 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/01.02 머신러닝용 파이썬 패키지.html">
   1.2 머신러닝용 파이썬 패키지
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/02.01 데이터 전처리 기초.html">
   2.1 데이터 전처리 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/02.02 범주형 데이터 처리.html">
   2.2 범주형 데이터 처리
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.01.01 NLTK 자연어 처리 패키지.html">
   NLTK 자연어 처리 패키지
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.01.02 KoNLPy 한국어 처리 패키지.html">
   KoNLPy 한국어 처리 패키지
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.01.03 Scikit-Learn의 문서 전처리 기능.html">
   Scikit-Learn의 문서 전처리 기능
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.01.04 soynlp.html">
   Soynlp 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.01.05 확률론적 언어 모형.html">
   확률론적 언어 모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.02.01 이미지 처리 기초.html">
   이미지 처리 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.02.02 이미지 필터링.html">
   이미지 필터링
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.02.03 이미지 컨투어.html">
   이미지 컨투어
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.02.04 이미지 변환.html">
   이미지 변환
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.02.05 이미지 특징 추출.html">
   이미지 특징 추출
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.03.01 사운드 프로세싱 기초.html">
   사운드 프로세싱 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.03.02 푸리에 변환과 스펙트럼.html">
   푸리에 변환과 스펙트럼
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.04.01 지리 정보 데이터 처리.html">
   지리 정보 데이터 처리
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/03.04.02 지오코딩.html">
   Geocoding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/04.01 회귀분석 예제.html">
   4.1 회귀분석 예제
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/04.02 선형회귀분석의 기초.html">
   4.2 선형회귀분석의 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/04.03 스케일링.html">
   4.3 스케일링
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/04.04 범주형 독립변수.html">
   4.4 범주형 독립변수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/04.05 부분회귀.html">
   4.5 부분회귀
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/05.01 확률론적 선형 회귀모형.html">
   5.1 확률론적 선형 회귀모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/05.02 회귀분석의 기하학.html">
   5.2 회귀분석의 기하학
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/05.03 레버리지와 아웃라이어.html">
   5.3 레버리지와 아웃라이어
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/05.04 분산 분석과 모형 성능.html">
   5.4 분산 분석과 모형 성능
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/06.01 모형 진단과 수정.html">
   6.1 모형 진단과 수정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/06.01 모형 진단과 수정.html#id2">
   잔차 정규성
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/06.01 모형 진단과 수정.html#id3">
   잔차와 독립 변수의 관계
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/06.01 모형 진단과 수정.html#id4">
   이분산성
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/06.01 모형 진단과 수정.html#id5">
   자기 상관 계수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/06.02 기저함수 모형과 과최적화.html">
   6.2 기저함수 모형과 과최적화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/06.03 교차검증.html">
   6.3 교차검증
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/06.04 다중공선성과 변수 선택.html">
   6.4 다중공선성과 변수 선택
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/06.04 다중공선성과 변수 선택.html#vif">
   VIF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/06.04 다중공선성과 변수 선택.html#id2">
   보스턴 집값 예측 문제에 응용
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/06.05 정규화 선형회귀.html">
   6.5 정규화 선형회귀
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/07.01 추천 시스템.html">
   13.1 추천 시스템
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/09.01 분류용 예제 데이터.html">
   5.1 분류용 예제 데이터
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/09.02 분류용 가상 데이터 생성.html">
   5.2 분류용 가상 데이터 생성
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/09.02 분류용 가상 데이터 생성.html#make-blobs">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_blobs
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/09.02 분류용 가상 데이터 생성.html#make-moons">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_moons
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/09.02 분류용 가상 데이터 생성.html#make-gaussian-quantiles">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_gaussian_quantiles
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/09.03 분류모형.html">
   5.3 분류모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/09.04 분류 성능평가.html">
   5.4 분류 성능평가
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/10.01 로지스틱 회귀분석.html">
   6.1 로지스틱 회귀분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/11.01 선형판별분석법과 이차판별분석법.html">
   7.1 선형판별분석법과 이차판별분석법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/11.02 나이브베이즈 분류모형.html">
   7.2 나이브베이즈 분류모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/11.03 감성 분석.html">
   감성 분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/12.01 의사결정나무.html">
   8.1 의사결정나무
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/12.02 모형 결합.html">
   12.02 모형 결합
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/12.03 부스팅 방법.html">
   부스팅 방법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/13.02 서포트 벡터 머신.html">
   서포트 벡터 머신
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/13.03 커널 서포트 벡터 머신.html">
   커널 서포트 벡터 머신
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/14.01 모형 최적화.html">
   모형 최적화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/14.02 비대칭 데이터 문제.html">
   비대칭 데이터 문제
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/14.03 특징 선택.html">
   특징 선택
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/14.04 대규모 데이터 학습.html">
   대규모 데이터 학습
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/16.01 군집화.html">
   군집화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/16.02 K-평균 군집화.html">
   K-평균 군집화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/16.03 디비스캔 군집화.html">
   디비스캔 군집화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/16.04 계층적 군집화.html">
   계층적 군집화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/16.05 Affinity Propagation.html">
   Affinity Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/17.01 그래프 이론 기초.html">
   그래프 이론 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/17.02 그래프 확률모형.html">
   그래프 확률모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/17.03 네트워크 추론.html">
   네트워크 추론
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/18.01 가우시안 혼합모형과 EM 방법.html">
   가우시안 혼합모형과 EM 방법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/18.02 변분법적 추론.html">
   변분법적 추론
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/19.01 몬테카를로 베이지안 분석.html">
   몬테카를로 베이지안 분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/19.02 베이지안 회귀 분석 예제.html">
   베이지안 회귀 분석 예제
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03 machine learning/20.01 히든 마코프 모형.html">
   히든 마코프 모형
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/02 mathematics/07.06 조건부기댓값과 예측 문제.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/datascienceschool/book/master?urlpath=tree/ds/02 mathematics/07.06 조건부기댓값과 예측 문제.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/datascienceschool/book/blob/master/ds/02 mathematics/07.06 조건부기댓값과 예측 문제.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   예측 문제
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   조건부기댓값의 성질
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   전체 기댓값의 법칙
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     연습 문제 7.6.1
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   조건부분산
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   전체 분산의 법칙
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>7.6 조건부기댓값과 예측 문제<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>확률변수 <span class="math notranslate nohighlight">\(Y\)</span>의 기댓값을 구할 때 주변 확률밀도함수 <span class="math notranslate nohighlight">\(p_Y(y)\)</span>를 사용하여 가중치를 계산하지 않고 조건부 확률밀도함수 <span class="math notranslate nohighlight">\(p_{Y\vert X}(y|x)\)</span>를 이용하여 가중치를 계산하면 <strong>조건부기댓값(conditional expectation)</strong> 혹은 **조건부평균(conditional mean)**이 된다.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
\text{E}_Y[Y \vert X] 
= \int_{y=-\infty}^{y=\infty} y \, p_{Y \vert X}(y|x) dy 
\tag{7.6.1}
\end{align}
\]</div>
<p>또는 간단히 다음처럼 쓴다.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
\text{E}[Y \vert X] 
= \int y \, p(y|x) dy 
\tag{7.6.2}
\end{align}
\]</div>
<p>조건부기댓값에서 조건이 되는 확률변수 <span class="math notranslate nohighlight">\(X\)</span>의 값 <span class="math notranslate nohighlight">\(x\)</span>는 조건부기댓값을 사용하는 사용자가 지정해야 하는 독립변수이다. 따라서 <strong>조건부기댓값은 조건이 되는 확률변수의 값에 따라서 값이 달라지는 확률변수</strong>이다. 또한 <span class="math notranslate nohighlight">\(\text{E}[Y \vert X]\)</span>는 조건이 되는 확률변수 <span class="math notranslate nohighlight">\(X\)</span>의 값 <span class="math notranslate nohighlight">\(x\)</span>를 입력으로 가지는 <strong>함수</strong>다.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
\text{E}[Y \vert X=x] = f(x) 
\tag{7.6.3}
\end{align}
\]</div>
<p>이 식은 간단히 다음처럼 쓰기도 한다.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
\text{E}[Y \vert x] = f(x) 
\tag{7.6.4}
\end{align}
\]</div>
<p><span class="math notranslate nohighlight">\(f(x)\)</span>는 조건이 되는 확률변수 <span class="math notranslate nohighlight">\(X\)</span>의 값 <span class="math notranslate nohighlight">\(x\)</span>를 입력받아서 결과가 되는 확률변수 <span class="math notranslate nohighlight">\(Y\)</span>의 기댓값을 출력하는 함수다.</p>
<p>그림 7.6.1 : 조건부기댓값</p>
<div class="section" id="id2">
<h2>예측 문제<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>두 확률변수가 <span class="math notranslate nohighlight">\(X, Y\)</span>에서 <span class="math notranslate nohighlight">\(X\)</span>의 값을 알고 있을 때 <span class="math notranslate nohighlight">\(Y\)</span>의 값을 알아내는 것을 **예측(prediction)**문제라고 한다. <span class="math notranslate nohighlight">\(Y\)</span>가 연속확률변수면 회귀분석(regression analysis), <span class="math notranslate nohighlight">\(Y\)</span>가 이산확률변수면 분류(classification)라고도 한다. <span class="math notranslate nohighlight">\(X\)</span>의 값 <span class="math notranslate nohighlight">\(x\)</span>을 알면 조건부확률분포 <span class="math notranslate nohighlight">\(P(y|x)\)</span>의 분포를 알 수 있지만 가장 대표성이 있는 하나의 값이 되어야하므로 일반적으로 조건부확률분포의 기댓값인 조건부기댓값을 예측문제의 답으로 하는 경우가 많다.
경우에 따라서는 예측문제의 답으로 중앙값이나 최빈값 등을 계산할 수도 있다. 예측문제의 답은 <span class="math notranslate nohighlight">\(\hat{y}\)</span>기호로 표기하기도 한다. 조건부기댓값은 <span class="math notranslate nohighlight">\(x\)</span>값의 함수이므로 이 함수를 구할 수 있으면 모든 <span class="math notranslate nohighlight">\(x\)</span>값에 대한 예측결과를 구한 것과 같다.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
x \xrightarrow {\text{예측}} \hat{y} = E[y|x] = f(x)
\tag{7.6.5}
\end{align}
\]</div>
</div>
<div class="section" id="id3">
<h2>조건부기댓값의 성질<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>조건부기댓값 <span class="math notranslate nohighlight">\(\text{E}[Y \vert X]\)</span>가 <span class="math notranslate nohighlight">\(X\)</span>의 함수, 즉 변환(transform)이므로 <strong>조건부기댓값 <span class="math notranslate nohighlight">\(\text{E}[Y \vert X]\)</span>도 확률변수</strong>다.</p>
<p>만약 확률변수 <span class="math notranslate nohighlight">\(Y\)</span>가 확률변수 <span class="math notranslate nohighlight">\(X\)</span>의 값을 독립변수로 하는 결정론적 함수값이라면</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
Y = g(X)
\tag{7.6.6}
\end{align}
\]</div>
<p>사용자가 <span class="math notranslate nohighlight">\(X\)</span>의 값을 어떤 값 <span class="math notranslate nohighlight">\(x\)</span>로 정하는 순간 <span class="math notranslate nohighlight">\(Y\)</span>의 값도 결정되어 버리기 때문에 <span class="math notranslate nohighlight">\(Y=g(X)\)</span>는 더이상 확률적인 값이 아니라 상수가 된다.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\text{E}[Y \vert X] = \text{E}[g(X) \vert X] = g(X)
\tag{7.6.7}
\end{align}
\]</div>
<p>같은 방식으로 확률변수 <span class="math notranslate nohighlight">\(X\)</span>와 <span class="math notranslate nohighlight">\(Y\)</span>가 결정론적 함수 관계가 아닐 때도 다음 등식이 성립한다.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\text{E}[g(X) Y \vert X] = g(X) \text{E}[Y \vert X]
\tag{7.6.8}
\end{align}
\]</div>
</div>
<div class="section" id="id4">
<h2>전체 기댓값의 법칙<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>조건부기댓값은 확률변수이므로 조건이 되는 확률변수에 대해 다시 기댓값을 구할 수 있다. 이렇게 반복하여 구한 조건부기댓값의 기댓값은 원래 확률변수의 댓값과 같다.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\text{E}_X[\text{E}_Y[Y \vert X]] = \text{E}_Y[Y]
\tag{7.6.9}
\end{align}
\]</div>
<p>간단히 다음처럼 쓰기도 한다.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\text{E}[\text{E}[Y \vert X]] = \text{E}[Y]
\tag{7.6.10}
\end{align}
\]</div>
<p>이를 <strong>전체 기댓값의 법칙(law of total expectation)</strong> 또는 **반복 기댓값의 법칙(law of iterated expectation)**이라고 한다.</p>
<p><span class="math notranslate nohighlight">\(X, Y\)</span>가 이산확률변수인 경우에는 다음처럼 증명할 수 있다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\begin{aligned}
\text{E}_X[\text{E}_Y[Y|X]] 
&amp;= \sum_{x_i\in X} p(x_i) \text{E}_Y[Y|X] \\
&amp;= \sum_{x_i\in X} p(x_i) \sum_{y_j \in Y} p(y_j|x_i) y_j \\
&amp;= \sum_{x_i\in X} \sum_{y_j \in Y} p(x_i) p(y_j|x_i) y_j \\
&amp;= \sum_{x_i\in X} \sum_{y_j \in Y} p(x_i, y_j) y_j \\
&amp;= \sum_{y_j \in Y} p(y_j) y_j \\
&amp;= \text{E}_Y[Y]
\end{aligned}
\tag{7.6.11}
\end{align}
\end{split}\]</div>
<div class="section" id="id5">
<h3>연습 문제 7.6.1<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>전체 기댓값의 법칙을 사용하여 다음을 증명하라.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\text{E}[(Y - \text{E}[Y \vert X])g(X)] = 0
\tag{7.6.12}
\end{align}
\]</div>
</div>
</div>
<div class="section" id="id6">
<h2>조건부분산<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>조건부기댓값을 정의한 것처럼 조건부분산(conditional variance)도 다음처럼 정의할 수 있다.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
\text{Var}_Y[Y \vert X] 
= \text{E}_Y[(Y - \text{E}_Y[Y \vert X])^2 \vert X] 
= \int (Y - \text{E}_Y[Y \vert X])^2 f_{Y \vert X}(y \vert x) dy 
\tag{7.6.13}
\end{align}
\]</div>
<p>조건부분산은 <span class="math notranslate nohighlight">\(x\)</span>의 값을 알고 있을 때 이에 대한 조건부확률분포 <span class="math notranslate nohighlight">\(p(y|x)\)</span>의 분산이다.</p>
<p>예측문제의 관점으로 보면 조건부분산은 예측의 불확실성, 즉 예측으로 맞출 수 없는 범위를 뜻한다.</p>
<p>그림 7.6.2 : 조건부분산</p>
</div>
<div class="section" id="id7">
<h2>전체 분산의 법칙<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>확률변수의 분산은 조건부분산의 기댓값과 조건부기댓값의 분산의 합과 같다. 이를 **전체 분산의 법칙(law of total variance)**라고 한다.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\text{Var}[Y] = \text{E}[\text{Var}[Y\vert X]] + \text{Var}[\text{E}[Y\vert X]]
\tag{7.6.14}
\end{align}
\]</div>
<p>전체 기댓값의 법칙을 사용하여 증명할 수 있다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\begin{aligned}
\text{Var}[Y] 
&amp;= \text{E}[Y^2] - (\text{E}[Y])^2 \\
&amp;= \text{E} \left[\text{E}[Y^2\mid X]\right] - (\text{E} [\text{E}[Y\mid X]])^2 \\
&amp;= \text{E} \left[\text{Var}[Y\mid X] + (\text{E}[Y\mid X])^2\right] - (\text{E}[\text{E}[Y\mid X]])^2 \\
&amp;= \text{E} [\text{Var}[Y\mid X]] + \left(\text{E} [[\text{E}[Y\mid X]]^2] - (\text{E} [\text{E}[Y\mid X]])^2\right) \\
&amp;= \text{E} [\text{Var}[Y\mid X]] + \text{Var} [\text{E}[Y\mid X]]
\end{aligned}
\tag{7.6.15}
\end{align}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\text{E}[Y\mid X] = \hat{y}\)</span>로 표현하면 다음과 같이 쓸 수 있다.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\text{Var}[Y] = \text{E}[(\hat{y}-y)^2] + \text{Var}[\hat{y}]
\tag{7.6.16}
\end{align}
\]</div>
<p>예측문제의 관점에서 조건부분산의 기댓값 <span class="math notranslate nohighlight">\(\text{E}[(\hat{y}-y)^2]\)</span>은 예측 오차 즉, 편향(bias)의 평균적인 크기를 뜻한다. 조건부기댓값의 분산 <span class="math notranslate nohighlight">\(\text{Var}[\hat{y}]\)</span>은 예측값의 변동 크기다. 예측값의 변동 크기가 증가한다는 것은 예측모형이 복잡하고 비선형적이며 주어진 데이터에 과최적화되기 쉽다는 의미다. 따라서 전체 분산의 법칙이 말하고자 하는 바는 예측 오차의 크기과 예측값의 변동의 합이 일정하므로 예측 오차를 줄이면 모형이 복잡해지고 과최적화가 되며 반대로 모형을 과최적화를 막기위해 단순하게 하면 예측 오차가 증가한다. 이를 <strong>편향-분산 상충(Bias–variance Tradeoff)</strong> 법칙이라고도 한다.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./02 mathematics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="07.05 공분산과 상관계수.html" title="previous page">7.5 공분산과 상관계수</a>
    <a class='right-next' id="next-link" href="08.00 8장 사이파이로 공부하는 확률분포.html" title="next page">8장 사이파이로 공부하는 확률분포</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.30270b6e4c972e43c488.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-77195005-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>