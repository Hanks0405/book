

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5.1 최적화 기초 &#8212; 데이터 사이언스 스쿨</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "datascienceschool/book");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.2 제한조건이 있는 최적화 문제" href="05.02 제한조건이 있는 최적화 문제.html" />
    <link rel="prev" title="5장 사이파이(SciPy)로 공부하는 최적화" href="05.00 5장 사이파이(SciPy)로 공부하는 최적화.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">데이터 사이언스 스쿨</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   데이터 사이언스 스쿨
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/00.00 김도형의 데이터 사이언스 스쿨 - 파이썬 편.html">
   파이썬 편
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="00.00 김도형의 데이터 사이언스 스쿨 - 수학 편.html">
   수학 편
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="00.00 소개의 글.html">
     소개의 글
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01.00 1장 수학 기호.html">
     1장 수학 기호
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="01.01 그리스 문자.html">
       1.1 그리스 문자
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="01.02 수열과 집합의 합과 곱.html">
       1.2 수열과 집합의 합과 곱
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02.00 2장 넘파이(NumPy)로 공부하는 선형대수.html">
     2장 넘파이(NumPy)로 공부하는 선형대수
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="02.01 데이터와 행렬.html">
       2.1 데이터와 행렬
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="02.02 벡터와 행렬의 연산.html">
       2.2 벡터와 행렬의 연산
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="02.03 행렬의 성질.html">
       2.3 행렬의 성질
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="02.04 선형 연립방정식과 역행렬.html">
       2.4 선형 연립방정식과 역행렬
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.00 3장 고급 선형대수.html">
     3장 고급 선형대수
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="03.01 선형대수와 해석기하의 기초.html">
       3.1 선형대수와 해석기하의 기초
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="03.02 좌표와 변환.html">
       3.2 좌표와 변환
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="03.03 고윳값 분해.html">
       3.3 고윳값 분해
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="03.04 특잇값 분해.html">
       3.4 특잇값 분해
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="03.05 PCA.html">
       3.5 PCA
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.00 4장 심파이(SymPy)로 공부하는 미적분.html">
     4장 심파이(SymPy)로 공부하는 미적분
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="04.01 함수.html">
       4.1 함수
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="04.02 심파이를 사용한 함수 미분.html">
       4.2 심파이를 사용한 함수 미분
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="04.03 적분.html">
       4.3 적분
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="04.04 행렬의 미분.html">
       4.4 행렬의 미분
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="04.05 변분법.html">
       4.5 변분법
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active">
    <a class="reference internal" href="05.00 5장 사이파이(SciPy)로 공부하는 최적화.html">
     5장 사이파이(SciPy)로 공부하는 최적화
    </a>
    <ul class="current">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       5.1 최적화 기초
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="05.02 제한조건이 있는 최적화 문제.html">
       5.2 제한조건이 있는 최적화 문제
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="05.03 선형계획법 문제와 이차계획법 문제.html">
       5.3 선형계획법 문제와 이차계획법 문제
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06.00 6장 피지엠파이(pgmpy)로 공부하는 확률론.html">
     6장 피지엠파이(pgmpy)로 공부하는 확률론
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="06.01 집합.html">
       6.1 집합
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="06.02 확률의 수학적 정의와 의미.html">
       6.2 확률의 수학적 정의와 의미
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="06.03 확률의 성질.html">
       6.3 확률의 성질
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="06.04 확률분포함수.html">
       6.4 확률분포함수
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="06.05 결합확률과 조건부확률.html">
       6.5 결합확률과 조건부확률
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="06.06 베이즈 정리.html">
       6.6 베이즈 정리
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.00 7장 확률변수와 상관관계.html">
     7장 확률변수와 상관관계
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="07.01 확률적 데이터와 확률변수.html">
       7.1 확률적 데이터와 확률변수
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="07.02 기댓값과 확률변수의 변환.html">
       7.2 기댓값과 확률변수의 변환
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="07.03 분산과 표준편차.html">
       7.3 분산과 표준편차
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="07.04 다변수 확률변수.html">
       7.4 다변수 확률변수
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="07.05 공분산과 상관계수.html">
       7.5 공분산과 상관계수
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="07.06 조건부기댓값과 예측 문제.html">
       7.6 조건부기댓값과 예측 문제
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08.00 8장 사이파이로 공부하는 확률분포.html">
     8장 사이파이로 공부하는 확률분포
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="08.01 사이파이를 이용한 확률분포 분석.html">
       8.1 사이파이를 이용한 확률분포 분석
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="08.02 베르누이분포와 이항분포.html">
       8.2 베르누이분포와 이항분포
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="08.03 카테고리분포와 다항분포.html">
       8.3 카테고리분포와 다항분포
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="08.04 정규분포와 중심극한정리.html">
       8.4 정규분포와 중심극한정리
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="08.05 스튜던트 t분포, 카이제곱분포, F분포.html">
       8.5 스튜던트 t분포, 카이제곱분포, F분포
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="08.06 다변수정규분포.html">
       8.6 다변수정규분포
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="08.07 베타분포, 감마분포, 디리클레 분포.html">
       8.7 베타분포, 감마분포, 디리클레분포
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09.00 9장 추정과 검정.html">
     9장 추정과 검정
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="09.01 확률분포의 추정.html">
       9.1 확률분포의 추정
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="09.02 최대가능도 추정법.html">
       9.2 최대가능도 추정법
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="09.03 베이즈 추정법.html">
       9.3 베이즈 추정법
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="09.04 검정과 유의확률.html">
       9.4 검정과 유의확률
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="09.05 사이파이를 사용한 검정.html">
       9.5 사이파이를 사용한 검정
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="10.00 10장 엔트로피.html">
     10장 엔트로피
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="10.01 엔트로피.html">
       10.1 엔트로피
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="10.02 조건부엔트로피.html">
       10.2 조건부엔트로피
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="10.03 교차엔트로피와 쿨백-라이블러 발산.html">
       10.3 교차엔트로피와 쿨백-라이블러 발산
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="10.04 상호정보량.html">
       10.4 상호정보량
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/02 mathematics/05.01 최적화 기초.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/02 mathematics/05.01 최적화 기초.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/02 mathematics/05.01 최적화 기초.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   최적화 문제
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     예제
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     예제
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   그리드 서치와 수치적 최적화
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   기울기 필요조건
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   최대경사법
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     예제
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     예제
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   2차 도함수를 사용한 뉴턴 방법
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id11">
   준 뉴턴 방법
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scipy">
   SciPy를 이용한 최적화
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     예제
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     예제
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     연습 문제 5.1.1
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id15">
   전역 최적화 문제
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id16">
   컨벡스 문제
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>5.1 최적화 기초<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>데이터 분석의 최종 단계는 가장 적합한 숫자를 찾아내는 최적화 단계가 된다. 이 절에서는 가장 기본적인 유형의 최적화 문제와 이를 풀기위한 수치적인 방법을 공부한다.</p>
<div class="section" id="id2">
<h2>최적화 문제<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>최적화 문제는 함수 <span class="math notranslate nohighlight">\(f\)</span>의 값을 최대화 혹은 최소화하는 변수 <span class="math notranslate nohighlight">\(x\)</span>의 값 <span class="math notranslate nohighlight">\(x^{\ast}\)</span>를 찾는 것이다. 수식으로는 다음처럼 쓴다.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
x^{\ast} = \arg \max_x f(x) 
\tag{5.1.1}
\end{align}
\]</div>
<p>또는</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
x^{\ast} = \arg \min_x f(x) 
\tag{5.1.2}
\end{align}
\]</div>
<p>이 값 <span class="math notranslate nohighlight">\(x^{\ast}\)</span>를 최적화 문제의 **해(solution)**라고 한다. 만약 최소화 문제를 풀 수 있다면 <span class="math notranslate nohighlight">\(f(x)\)</span>를 <span class="math notranslate nohighlight">\(-f(x)\)</span>로 바꾸어 위아래를 뒤집은 다음 최소화 문제를 풀면 <span class="math notranslate nohighlight">\(f(x)\)</span>의 최대화 문제를 푼 것과 같다. 따라서 보통은 최소화 문제만 고려한다.</p>
<p>이때 최소화하려는 함수 <span class="math notranslate nohighlight">\(f(x)\)</span>를 <strong>목적함수(objective function)</strong>, <strong>비용함수(cost function)</strong>, <strong>손실함수(loss function)</strong> <strong>오차함수(error function)</strong> 등으로 부른다. 기호로는 각각 <span class="math notranslate nohighlight">\(J, C, L, E\)</span>로 표기하는 경우가 많다.</p>
<div class="section" id="id3">
<h3>예제<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>다음은 1차원 목적함수의 예이다. 그래프에서 이 목적함수 <span class="math notranslate nohighlight">\(f_1(x)\)</span>의 최저점은 <span class="math notranslate nohighlight">\(x^{\ast}=2\)</span>임을 알 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f_1(x)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;1차원 목적함수&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05.01 최적화 기초_5_0.png" src="../_images/05.01 최적화 기초_5_0.png" />
</div>
</div>
</div>
<div class="section" id="id4">
<h3>예제<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>다음 함수 <span class="math notranslate nohighlight">\(f_2(x, y)\)</span>는 2차원 목적함수의 예로 2차원 로젠브록(Rosenbrock) 함수라고 한다. 2차원 로젠브록  함수는 <span class="math notranslate nohighlight">\(x^{\ast}, y^{\ast} = (1, 1)\)</span>에서 최솟값을 가진다.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
f(x, y) = (1 − x )^2 + 100(y − x^2)^2
\tag{5.1.3}
\end{align}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
            <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">5000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;2차원 로젠브록 함수 $f(x,y)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05.01 최적화 기초_7_0.png" src="../_images/05.01 최적화 기초_7_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id5">
<h2>그리드 서치와 수치적 최적화<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>목적함수의 값을 가장 작게 하는 <span class="math notranslate nohighlight">\(x\)</span> 위치를 찾는 최적화 문제를 푸는 가장 간단한 방법은 가능한 <span class="math notranslate nohighlight">\(x\)</span>의 값을 여러개 넣어 보고 그중 가장 작은 값을 선택하는 <strong>그리드 서치(grid search)</strong> 방법이다. 함수 <span class="math notranslate nohighlight">\(f_1(x)\)</span>의 그래프를 그려 최저점을 찾은 방법도 그리드 서치 방법의 일종이다.
그리드 서치는 가장 간단한 방법이지만 많은 <span class="math notranslate nohighlight">\(x\)</span> 위치에 대해 목적함숫값을 계산해야 한다. 위에서 함수 <span class="math notranslate nohighlight">\(f_1(x)\)</span>의 최저점을 찾을 때는 사실 함수 계산을 100번 수행했다.</p>
<p>예측 모형을 만들 때 목적함숫값, 즉 예측 오차를 구하려면 모든 트레이닝 데이터 집합에 대해 예측값과 타깃값의 차이를 구해야 하므로 계산량이 상당히 크다. 따라서 그리드 서치보다 목적함수 계산을 적게 할 수 있는 방법이 필요하다.</p>
<p>반복적 시행 착오(trial and error)에 의해 최적화 필요조건을 만족하는 값 <span class="math notranslate nohighlight">\(x^{\ast}\)</span>를 찾는 방법을 **수치적 최적화(numerical optimization)**라고 한다.  수치적 최적화 방법은 함수 위치가 최적점이 될 때까지 가능한 한 적은 횟수만큼 <span class="math notranslate nohighlight">\(x\)</span> 위치를 옮기는 방법을 말한다.</p>
<p>수치적 최적화 방법은 다음 두 가지 알고리즘을 요구한다.</p>
<ul class="simple">
<li><p>현재 위치 <span class="math notranslate nohighlight">\(x_k\)</span>가 최적점인지 판단하는 알고리즘</p></li>
<li><p>어떤 위치 <span class="math notranslate nohighlight">\(x_k\)</span>를 시도한 뒤, 다음 번에 시도할 위치 <span class="math notranslate nohighlight">\(x_{k+1}\)</span>을 찾는 알고리즘</p></li>
</ul>
</div>
<div class="section" id="id6">
<h2>기울기 필요조건<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>우선 현재 시도하고 있는 위치 <span class="math notranslate nohighlight">\(x\)</span>가 최소점인지 아닌지 알아내는 알고리즘을 생각해 보자.</p>
<p>어떤 독립 변수 값 <span class="math notranslate nohighlight">\(x^{\ast}\)</span>가 최소점이려면 일단 다음과 같이 값 <span class="math notranslate nohighlight">\(x^{\ast}\)</span>에서 함수의 기울기(slope)와 도함수 <span class="math notranslate nohighlight">\(\dfrac{df}{dx}\)</span> 값이 0이라는 조건을 만족해야 한다. 이를 <strong>기울기 필요조건</strong>이라고 한다.</p>
<p>단일 변수에 대한 함수인 경우, <strong>미분값이 0이어야 한다.</strong></p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
\dfrac{df(x)}{dx} = 0
\tag{5.1.4}
\end{align}
\]</div>
<p>다변수 함수인 경우 <strong>모든 변수에 대한 편미분값이 0이어야 한다.</strong></p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\dfrac{\partial f(x_1, x_2, \cdots , x_N)}{\partial x_1} = 0
\tag{5.1.5}
\end{align}
\]</div>
<div class="math notranslate nohighlight">
\[
\begin{align}
\dfrac{\partial f(x_1, x_2, \cdots , x_N)}{\partial x_2} = 0
\tag{5.1.6}
\end{align}
\]</div>
<div class="math notranslate nohighlight">
\[
\begin{align}
\vdots
\tag{5.1.7}
\end{align}
\]</div>
<div class="math notranslate nohighlight">
\[
\begin{align}
\dfrac{\partial f(x_1, x_2, \cdots , x_N)}{\partial x_N} = 0
\tag{5.1.8}
\end{align}
\]</div>
<p>즉</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
\nabla f = 0 
\tag{5.1.9}
\end{align}
\]</div>
<p>이때 그레디언트(gradient) 벡터 <span class="math notranslate nohighlight">\(\nabla f\)</span>를 <span class="math notranslate nohighlight">\(g\)</span>라는 기호로 간단하게 나타내기도 한다.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
g = 0
\tag{5.1.10}
\end{align}
\]</div>
<p>이 조건을 필요조건이라고 하는 이유는 기울기가 0이라고 반드시 최소점이 되지는 않지만, 모든 최소점은 기울기가 0이기 때문이다. 일반적인 수치적 최적화 알고리즘에서는 기울기 필요조건을 이용하여 최적점에 도달했는지 판단한다.</p>
<p>기울기가 0이어도 최소점이 아니라 최고점일 수도 있다. 기울기가 0인 위치가 최소점임을 확인하려면 2차 도함수의 부호도 계산해야 한다. 기울기가 0이고 2차도함수가 양수면 최소점이다. 반대로 기울기가 0이고 2차 도함수가 음수면 최대점이 된다.</p>
</div>
<div class="section" id="id7">
<h2>최대경사법<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p><strong>최대경사법(Steepest Gradient Descent)방법</strong>은 단순히 현재 위치 <span class="math notranslate nohighlight">\(x_k\)</span>에서의 기울기 값 <span class="math notranslate nohighlight">\(g(x_k)\)</span> 만을 이용하여 다음번 위치 <span class="math notranslate nohighlight">\(x_{k+1}\)</span>를 결정하는 방법이다.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
x_{k+1} = x_{k} - \mu \nabla f(x_k) = x_{k} - \mu g(x_k) 
\tag{5.1.11}
\end{align}
\]</div>
<p>만약 현재 위치 <span class="math notranslate nohighlight">\(x_k\)</span>에서 기울기가 음수면 즉 곡면이 아래로 향하면 <span class="math notranslate nohighlight">\(g(x_k) &lt; 0\)</span>이므로 앞으로 진행하고 현재 위치 <span class="math notranslate nohighlight">\(x_k\)</span>에서 기울기가 양수면  <span class="math notranslate nohighlight">\(g(x_k) &gt; 0\)</span>이므로 뒤로 진행하게 되어 점점 낮은 위치로 옮겨간다. 이때 위치를 옮기는 거리를 결정하는 비례상수 <span class="math notranslate nohighlight">\(\mu\)</span>를 **스텝 사이즈(step size)**라고 한다.</p>
<p><span class="math notranslate nohighlight">\(x_k\)</span>가 일단 최적 점에 도달했을 때는 <span class="math notranslate nohighlight">\(g(x_k) = 0\)</span>이 되므로 더 이상 위치를 옮기지 않는다.</p>
<div class="section" id="id8">
<h3>예제<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>위에서 예로 든 1차원 목적함수를 이 방법으로 최적화하면 다음과 같다. 우선 사람이 직접 목적함수를 미분하여 도함수를 파이썬으로 구현해야 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;f1(x)의 도함수&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(x=0\)</span>에서 시작하여 최대경사법으로 최적점을 찾아나가는 과정은 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>

<span class="c1"># step size</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="c1"># k = 0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;1차 시도&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1차 시도: x_1 = </span><span class="si">{:.2f}</span><span class="s2">, g_1 = </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

<span class="c1"># k = 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s2">&quot;2차 시도&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2차 시도: x_2 = </span><span class="si">{:.2f}</span><span class="s2">, g_2 = </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

<span class="c1"># k = 2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;3차 시도&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3차 시도: x_3 = </span><span class="si">{:.2f}</span><span class="s2">, g_3 = </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f_1(x)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;최대경사법을 사용한 1차함수의 최적화&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1차 시도: x_1 = 0.00, g_1 = -4.00
2차 시도: x_2 = 1.60, g_2 = -0.80
3차 시도: x_3 = 1.92, g_3 = -0.16
</pre></div>
</div>
<img alt="../_images/05.01 최적화 기초_17_1.png" src="../_images/05.01 최적화 기초_17_1.png" />
</div>
</div>
<p>최대경사법에서는 스텝 사이즈의 크기를 적절히 조정하는 것이 중요하다. 보통 스텝 사이즈를 사용자가 경험적으로 얻는 값으로 고정하거나 특정한 알고리즘에 따라 변화시킨다. 하지만 스텝 사이즈가 너무 작으면 최저점을 찾아가는데 시간이 너무 오래 걸리고 스텝 사이즈가 너무 크면 다음 그림과 같이 오히려 최저점에서 멀어지는 현상이 발생할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>

<span class="c1"># step size (너무 큰 값!)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1.1</span>

<span class="c1"># k = 0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;1차 시도&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1차 시도: x_1 = </span><span class="si">{:.2f}</span><span class="s2">, g_1 = </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

<span class="c1"># k = 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s2">&quot;2차 시도&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2차 시도: x_2 = </span><span class="si">{:.2f}</span><span class="s2">, g_2 = </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

<span class="c1"># k = 2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;3차 시도&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3차 시도: x_3 = </span><span class="si">{:.2f}</span><span class="s2">, g_3 = </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1d</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f_1(x)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;최대경사법을 사용한 1차함수의 최적화 (스텝 사이즈가 너무 큰 경우)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1차 시도: x_1 = 0.00, g_1 = -4.00
2차 시도: x_2 = 4.40, g_2 = 4.80
3차 시도: x_3 = -0.88, g_3 = -5.76
</pre></div>
</div>
<img alt="../_images/05.01 최적화 기초_19_1.png" src="../_images/05.01 최적화 기초_19_1.png" />
</div>
</div>
</div>
<div class="section" id="id9">
<h3>예제<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>2차원 Rosenbrock 함수에 대해 최대경사법을 적용해보자. 목적함수를 미분하여 도함수를 구한 다음 그레디언트 벡터를 파이썬 함수로 구현한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f2g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;f2(x, y)의 도함수&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">400.0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="mf">200.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>다음 그림에 <span class="math notranslate nohighlight">\(x=-1, y-1\)</span>에서 시작하여 최대경사법으로 최적점을 찾아나가는 과정을 그레디언트 벡터 화살표와 함께 보였다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">8e-4</span>  <span class="c1"># step size</span>
<span class="n">s</span> <span class="o">=</span> <span class="mf">0.95</span>  <span class="c1"># for arrowhead drawing</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">f2g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">s</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
              <span class="n">head_width</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;최대경사법을 사용한 2차함수의 최적화&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05.01 최적화 기초_23_0.png" src="../_images/05.01 최적화 기초_23_0.png" />
</div>
</div>
<p>최적화 결과는 시작점의 위치나 스텝 사이즈 등에 따라 크게 달라진다. 다음 그림에서 볼 수 있듯이 최대경사법 방법은 곡면의 모양이 **계곡(valley)**과 같이 생긴 경우, 즉 그레디언트 벡터가 최저점을 가리키고 있지 않는 경우에는 <strong>진동(oscillation) 현상</strong>이 발생한다. 따라서 수렴하기까지 시간이 오래 걸릴 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">1.8e-3</span>  <span class="c1"># 스텝 사이즈</span>
<span class="n">s</span> <span class="o">=</span> <span class="mf">0.95</span>  <span class="c1"># 화살표 크기</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">f2g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">s</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
              <span class="n">head_width</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;최대경사법을 사용한 2차함수의 최적화 (진동 현상)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05.01 최적화 기초_25_0.png" src="../_images/05.01 최적화 기초_25_0.png" />
</div>
</div>
<p>이러한 진동 현상을 없앨 수 있는 방법으로는 2차 도함수, 즉 헤시안 행렬을 이용하는 방법이나 모멘텀 방법(momentum)이 있다. 모멘텀 방법은 진행 방향으로 계속 진행하도록 성분(모멘텀)을 추가하는 것이다. 일반적인 경우에는 2차 도함수를 이용하는 방법을 사용하고 2차 도함수를 계산하기 어려운 인공신경망 등에서는 모멘텀 방법을 선호한다. 모멘텀 방법(momentum)에 대해서는 이 책에서 다루지 않는다.</p>
</div>
</div>
<div class="section" id="id10">
<h2>2차 도함수를 사용한 뉴턴 방법<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p><strong>뉴턴(Newton) 방법</strong>은 목적함수가 2차 함수라는 가정하에 한 번에 최저점을 찾는다. 그레디언트 벡터에 헤시안 행렬의 역행렬을 곱해서 방향과 거리가 변형된 그레디언트 벡터를 사용한다</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
{x}_{n+1} = {x}_n - [{H}f({x}_n)]^{-1} \nabla f({x}_n) 
\tag{5.1.12}
\end{align}
\]</div>
<p>스텝 사이즈가 필요없고 목적함수가 실제로 2차함수와 비슷한 모양이면 빨리 수렴할 수 있다는 장점이 있지만 1차 도함수(그레디언트 벡터)뿐 아니라 2차 도함수(헤시안 행렬)도 필요로 한다.</p>
<p>예를 들어 다음 단변수 2차 함수</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
f(x) = a(x-x_0)^2 + c = ax^2 -2ax_0x + x_0^2+c
\tag{5.1.13}
\end{align}
\]</div>
<p>는 <span class="math notranslate nohighlight">\(x=x_0\)</span>에서 최솟값을 가진다.</p>
<p>단변수함수 뉴턴 방법은 다음과 같다. 즉 최적의 스텝 사이즈가 <span class="math notranslate nohighlight">\(\frac{1}{f''(x_n)}\)</span>이라는 것을 보여준다.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
{x}_{n+1} = {x}_n - \dfrac{f'(x_n)}{f''(x_n)}
\tag{5.1.14}
\end{align}
\]</div>
<p>2차 함수에 대해 도함수와 2차 도함수가</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
f'(x) = 2ax - 2ax_0
\tag{5.1.15}
\end{align}
\]</div>
<div class="math notranslate nohighlight">
\[
\begin{align}
f''(x) = 2a
\tag{5.1.16}
\end{align}
\]</div>
<p>이므로 뉴턴 방법에 적용하면</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
{x}_{n+1} = {x}_n - \dfrac{2ax_n - 2ax_0}{2a} = x_n - (x_n - x_0) = x_0
\tag{5.1.17}
\end{align}
\]</div>
<p>이므로 어떤 점 <span class="math notranslate nohighlight">\(x_n\)</span>에서 시작해도 바로 최저점으로 이동한다.</p>
</div>
<div class="section" id="id11">
<h2>준 뉴턴 방법<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<p>뉴턴 방법은 목적함수가 2차 함수와 비슷한 모양을 가진 경우에 빠르게 수렴할 수 있다는 장점이 있지만 2차도함수인 헤시안 행렬 함수를 사람이 미리 구현해야 하고 함수의 모양에 따라서는 잘 수렴하지 않을 수도 있다. <strong>준 뉴턴(Quasi-Newton) 방법</strong>에서는 사람이 구한 헤시안 행렬 함수를 사용하는 대신 현재 시도하고 있는 <span class="math notranslate nohighlight">\(x_n\)</span> 주변의 몇몇 점에서 함수의 값을 구하고 이를 이용하여 2차 도함수의 근사값 혹은 이에 상응하는 정보를 수치적으로 계산한다. 준 뉴턴 방법 중에서 BFGS(Broyden–Fletcher–Goldfarb–Shanno) 방법이 많이 사용된다.</p>
<p>CG(conjugated gradient) 방법은 준 뉴턴 방법처럼 헤시안 행렬을 필요로 하지 않고 변형된 그레디언트 벡터를 바로 계산한다.</p>
</div>
<div class="section" id="scipy">
<h2>SciPy를 이용한 최적화<a class="headerlink" href="#scipy" title="Permalink to this headline">¶</a></h2>
<p>사이파이(SciPy)의 optimize 서브 패키지는  최적화 명령 <code class="docutils literal notranslate"><span class="pre">minimize()</span></code>를 제공한다. 세부적인 알고리즘은 <code class="docutils literal notranslate"><span class="pre">method</span></code> 인수로 선택할 수 있다. 디폴트 알고리즘은 앞에서 설명한 BFGS 방법이다. <code class="docutils literal notranslate"><span class="pre">minimize()</span></code> 명령은 최적화할 함수와 최적화를 시작할 초깃값을 인수로 받는다. 더 자세한 내용은 사이파이 문서를 참조한다. (https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">jac</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code>: 목적함수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x0</span></code>: 초깃값 벡터</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jac</span></code>: (옵션) 그레디언트 벡터를 출력하는 함수</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">minimize()</span></code> 명령의 결과는 <code class="docutils literal notranslate"><span class="pre">OptimizeResult</span></code> 클래스 객체로 다음 속성을 가진다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>: 최적화 해</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">success</span></code>: 최적화에 성공하면 <code class="docutils literal notranslate"><span class="pre">True</span></code> 반환</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code>: 종료 상태. 최적화에 성공하면 0 반환</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code>: 메시지 문자열</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fun</span></code>: x 위치에서의 함수의 값</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jac</span></code>: x 위치에서의 자코비안(그레디언트) 벡터의 값</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hess_inv</span></code>: x 위치에서의 헤시안 행렬의 역행렬의 값</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nfev</span></code>: 목적함수 호출 횟수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">njev</span></code>: 자코비안 계산 횟수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nhev</span></code>: 헤시안 계산 횟수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nit</span></code>: x 이동 횟수</p></li>
</ul>
<div class="section" id="id12">
<h3>예제<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">minimize()</span></code> 명령으로 위에서 예로 들었던 1차원 함수를 최적화하면 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 목적함수 재정의</span>
<span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>

<span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 초깃값</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: 2.0
 hess_inv: array([[0.5]])
      jac: array([0.])
  message: &#39;Optimization terminated successfully.&#39;
     nfev: 9
      nit: 2
     njev: 3
   status: 0
  success: True
        x: array([1.99999999])
</pre></div>
</div>
</div>
</div>
<p>이 결과를 보면 최적해를 찾기 전에 x값의 위치는 2번밖에 바뀌지 않았지만 함수 호출 횟수는 9번이다. 그 이유는 그레디언트 계산에 필요한 1차 미분(그레디언트 벡터) 함수나 헤시안 함수가 주어지지 않았기 때문에 x값의 위치 근처에서 여러 번 함수를 계산하여 그레디언트 벡터의 근사값을 찾는 방법을 쓰기 때문이다. 이를 막고 계산량을 줄이려면 사람이 직접 그레디언트 벡터값을 반환하는 함수를 만들어 <code class="docutils literal notranslate"><span class="pre">jac</span></code> 인수로 넣어주면 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f1p</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;f1(x)의 도함수&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">f1p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: 2.0
 hess_inv: array([[0.5]])
      jac: array([0.])
  message: &#39;Optimization terminated successfully.&#39;
     nfev: 3
      nit: 2
     njev: 3
   status: 0
  success: True
        x: array([2.])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id13">
<h3>예제<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>다변수 함수를 최적화하는 경우에는 목적함수가 벡터 인수를 가져야 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2차원 목적함수 재정의(벡터 입력을 받도록)</span>
<span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">x0</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: 1.2197702024999478e-11
 hess_inv: array([[0.50957143, 1.01994476],
       [1.01994476, 2.04656074]])
      jac: array([ 9.66714798e-05, -4.64005023e-05])
  message: &#39;Desired error not necessarily achieved due to precision loss.&#39;
     nfev: 496
      nit: 57
     njev: 121
   status: 2
  success: False
        x: array([0.99999746, 0.99999468])
</pre></div>
</div>
</div>
</div>
<p>이 예와 같이 최적화에 성공하지 못하는 경우도 있기 때문에 성공 여부를 확인하고 최적화 결과를 이용해야 한다.</p>
</div>
<div class="section" id="id14">
<h3>연습 문제 5.1.1<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>2차원 로젠브록 함수에 대해</p>
<p>(1) 최적해에 수렴할 수 있도록 초기점을 변경하여 본다.</p>
<p>(2) 그레디언트 벡터 함수를 구현하여 <code class="docutils literal notranslate"><span class="pre">jac</span></code> 인수로 주는 방법으로 계산 속도를 향상시킨다.</p>
</div>
</div>
<div class="section" id="id15">
<h2>전역 최적화 문제<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<p>만약 최적화하려는 함수가 <strong>복수의 국소 최저점(local minima)을 가지고 있는 경우에는 수치적 최적화 방법으로 전역 최저점(global minimum)에 도달한다는 보장이 없다</strong>. 결과는 초기 추정값 및 알고리즘, 파라미터 등에 의존한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_global</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;비선형 목적함수&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_global</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_global</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;전역 최적화 문제&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05.01 최적화 기초_44_0.png" src="../_images/05.01 최적화 기초_44_0.png" />
</div>
</div>
<p>다음은 초깃값이 좋지 않아서 전역 최저점으로 수렴하지 못하는 경우이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f_global</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">x_sol</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="n">x_sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: 15.791736781359312
 hess_inv: array([[0.05417267]])
      jac: array([-2.38418579e-07])
  message: &#39;Optimization terminated successfully.&#39;
     nfev: 30
      nit: 6
     njev: 10
   status: 0
  success: True
        x: array([5.67920777])
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5.67920777])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_global</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_sol</span><span class="p">,</span> <span class="n">f_global</span><span class="p">(</span><span class="n">x_sol</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;전역 최적화에서 국소 최저점에 수렴하는 경우&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05.01 최적화 기초_47_0.png" src="../_images/05.01 최적화 기초_47_0.png" />
</div>
</div>
</div>
<div class="section" id="id16">
<h2>컨벡스 문제<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<p>목적함수의 2차 도함수의 값이 항상 0 이상이 되는 영역에서만 정의된 최적화 문제를 <strong>컨벡스(convex) 문제</strong>라고 한다.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
\dfrac{\partial^2 f}{\partial x^2} \geq 0 
\tag{5.1.18}
\end{align}
\]</div>
<p>다변수 목적함수의 경우에는 주어진 영역에서 헤시안 행렬이 항상 양의 준정부호(positive semidefinite)이라는 조건이 된다.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{align}
x^THx \geq 0 \;\;\text{for all } x 
\tag{5.1.19}
\end{align}
\]</div>
<p><strong>컨벡스 문제에서는 항상 전역 최저점이 존재한다.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f2prime</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">400</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                     <span class="mi">200</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)])</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="n">jac</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: 2.0894341548127262e-11
 hess_inv: array([[0.49022117, 0.98027058],
       [0.98027058, 1.96519149]])
      jac: array([ 1.58933954e-06, -8.86397000e-07])
  message: &#39;Optimization terminated successfully.&#39;
     nfev: 100
      nit: 18
     njev: 25
   status: 0
  success: True
        x: array([0.99999543, 0.99999085])
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./02 mathematics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="05.00 5장 사이파이(SciPy)로 공부하는 최적화.html" title="previous page">5장 사이파이(SciPy)로 공부하는 최적화</a>
    <a class='right-next' id="next-link" href="05.02 제한조건이 있는 최적화 문제.html" title="next page">5.2 제한조건이 있는 최적화 문제</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By 김도형<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>