

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dask 사용법 기초 &#8212; 데이터 사이언스 스쿨</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "datascienceschool/book");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="시각화 패키지 Matplotlib 소개" href="05.01 시각화 패키지 Matplotlib 소개.html" />
    <link rel="prev" title="시계열 자료 다루기" href="04.08 시계열 자료 다루기.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">데이터 사이언스 스쿨</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   데이터 사이언스 스쿨
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  01 python/00.00 김도형의 데이터 사이언스 스쿨 - 파이썬 편.ipynb
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01.01 커맨드 라인 인터페이스.html">
   1.1 커맨드 라인 인터페이스
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.02 파이썬 설치하기.html">
   1.2 파이썬 설치하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.03 파이썬 처음 사용하기.html">
   1.3 파이썬 처음 사용하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.04 파이썬 패키지 설치하기.html">
   1.4 파이썬 패키지 설치하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.05 데이터 분석용 파이썬 패키지 소개.html">
   1.5 데이터 분석용 파이썬 패키지 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.06 아이파이썬 및 주피터 설정.html">
   1.6 아이파이썬 및 주피터 설정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.07 구글 코랩 사용법.html">
   1.7 구글 코랩 사용법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.01 파이썬을 계산기로 사용하기.html">
   파이썬을 계산기로 사용하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.02 부동소수점 실수 자료형.html">
   부동소수점 실수 자료형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.03 파이썬으로 글자를 출력하기.html">
   파이썬으로 글자를 출력하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.04 파이썬의 문자열 형식화.html">
   파이썬의 문자열 형식화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.05 파이썬 조건문 기초.html">
   파이썬 조건문 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.06 파이썬 함수.html">
   파이썬 함수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.07 파이썬 for 반복문.html">
   파이썬 for 반복문
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.08 여러 개의 자료를 한 변수에 담기.html">
   여러 개의 자료를 한 변수에 담기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.09 파이썬에서 리스트 자료형 다루기.html">
   파이썬에서 리스트 자료형 다루기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.10 리스트와 반복문을 사용하여 계산하기.html">
   리스트와 반복문을 사용하여 계산하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.11 파이썬에서 딕셔너리 자료형 다루기.html">
   파이썬에서 딕셔너리 자료형 다루기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.12 파이썬 객체지향 프로그래밍.html">
   파이썬 객체지향 프로그래밍
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.13 파이썬 패키지 사용하기.html">
   파이썬 패키지 사용하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.14 파이썬의 자료형.html">
   파이썬의 자료형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.15 파이썬의 문자열 인코딩.html">
   파이썬의 문자열 인코딩
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.16 파이썬에서 날짜와 시간 다루기.html">
   파이썬에서 날짜와 시간 다루기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01 NumPy 배열.html">
   NumPy 배열
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02 배열의 생성과 변형.html">
   배열의 생성과 변형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.03 배열의 연산.html">
   배열의 연산
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.04 기술 통계.html">
   기술 통계
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.05 난수 발생과 카운팅.html">
   난수 발생과 카운팅
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.01 Pandas 패키지의 소개.html">
   Pandas 패키지의 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.02 데이터 입출력.html">
   데이터 입출력
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.03 데이터프레임 고급 인덱싱.html">
   데이터프레임 고급 인덱싱
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.04 데이터프레임의 데이터 조작.html">
   데이터프레임의 데이터 조작
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.05 데이터프레임 인덱스 조작.html">
   데이터프레임 인덱스 조작
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.06 데이터프레임 합성.html">
   데이터프레임 병합
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.07 피봇테이블과 그룹분석.html">
   피봇테이블과 그룹분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.08 시계열 자료 다루기.html">
   시계열 자료 다루기
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Dask 사용법 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.01 시각화 패키지 Matplotlib 소개.html">
   시각화 패키지 Matplotlib 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.02 Matplotlib의 여러가지 플롯.html">
   Matplotlib의 여러가지 플롯
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.03 Matplotlib의 삼각 그리드 사용법.html">
   Matplotlib의 triangular grid 사용법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.04 Seaborn을 사용한 데이터 분포 시각화.html">
   Seaborn을 사용한 데이터 분포 시각화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.05 Pandas의 시각화 기능.html">
   Pandas의 시각화 기능
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  02 mathematics/00.00 김도형의 데이터 사이언스 스쿨 - 수학 편.ipynb
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/00.00 소개의 글.html">
   소개의 글
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/01.00 1장 수학 기호.html">
   1장 수학 기호
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/02.00 2장 넘파이(NumPy)로 공부하는 선형대수.html">
   2장 넘파이(NumPy)로 공부하는 선형대수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/03.00 3장 고급 선형대수.html">
   3장 고급 선형대수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/04.00 4장 심파이(SymPy)로 공부하는 미적분.html">
   4장 심파이(SymPy)로 공부하는 미적분
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/05.00 5장 사이파이(SciPy)로 공부하는 최적화.html">
   5장 사이파이(SciPy)로 공부하는 최적화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/06.00 6장 피지엠파이(pgmpy)로 공부하는 확률론.html">
   6장 피지엠파이(pgmpy)로 공부하는 확률론
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/07.00 7장 확률변수와 상관관계.html">
   7장 확률변수와 상관관계
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/08.00 8장 사이파이로 공부하는 확률분포.html">
   8장 사이파이로 공부하는 확률분포
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/09.00 9장 추정과 검정.html">
   9장 추정과 검정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/10.00 10장 엔트로피.html">
   10장 엔트로피
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/01 python/04.09 Dask 사용법 기초.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/01 python/04.09 Dask 사용법 기초.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/01 python/04.09 Dask 사용법 기초.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   가상 데이터프레임
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   복수 데이터에 대한 가상 데이터프레임
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   대량 데이터의 병렬 처리
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="dask">
<h1>Dask 사용법 기초<a class="headerlink" href="#dask" title="Permalink to this headline">¶</a></h1>
<p>Pandas 는 데이터베이스나 CSV 파일의 데이터를 모두 메모리로 읽어들인 다음 메모리 위에서 데이터를 처리한다. 하지만 데이터의 양이 많은 경우에는 메모리의 제한으로 데이터프레임을 만들 수 없는 경우가 있다. 또한 데이터프레임의 크기가 너무 크면 질의나 그룹 연산을 할 때 하나의 CPU 코어로 처리하기에는 시간이 너무 많이 걸릴 수도 있다.</p>
<p>이러한 경우에 도움이 되는 것이 Dask 패키지이다. Dask 패키지는 Pandas 데이터프레임 형식으로 빅데이터를 처리하기 위한 파이썬 패키지로 다음과 같은 두 가지 기능을 가진다.</p>
<ol class="simple">
<li><p>가상 데이터프레임</p></li>
<li><p>병렬처리용 작업 스케줄러</p></li>
</ol>
<div class="section" id="id1">
<h2>가상 데이터프레임<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Dask 패키지를 사용하면 가상 데이터프레임을 만들 수 있다. 가상 데이터프레임은 Pandas 데이터프레임과 비슷한 기능을 제공하지만 실제로 모든 데이터가 메모리 상에 로드되어 있는 것이 아니라 하나 이상의 파일 혹은 데이터베이스에 존재하는 채로 처리할 수 있는 기능이다. 따라서 메모리 크기와 관계 없이 엄청나게 큰 CSV 파일을 가상 데이터프레임으로 로드하거나 같은 형식의 데이터를 가진 여러개의 CSV 파일을 하나의 가상 데이터프레임에 로드할 수 있다.</p>
<p>실제로 Dask의 가상 데이터프레임을 어떻게 쓸 수 있는지 실습을 통해 알아보자. 실습을 위해 홈 디렉토리 아래에 data라는 임시 디렉토리를 만들고 그곳으로 옮겨 CSV 파일을 하나 만들어 보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> data1.csv
<span class="n">time</span><span class="p">,</span><span class="n">temperature</span><span class="p">,</span><span class="n">humidity</span>
<span class="mi">0</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">58</span>
<span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">57</span>
<span class="mi">2</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">57</span>
<span class="mi">3</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">55</span>
<span class="mi">4</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">53</span>
<span class="mi">5</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">59</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing data1.csv
</pre></div>
</div>
</div>
</div>
<p>Dask 패키지의 dataframe 서브패키지를 <code class="docutils literal notranslate"><span class="pre">dd</span></code>라는 이름으로 임포트한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">read_csv</span></code> 명령으로 데이터 파일 <code class="docutils literal notranslate"><span class="pre">data1.csv</span></code>에 대한 가상 데이터프레임 <code class="docutils literal notranslate"><span class="pre">df</span></code>를 만든다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data1.csv&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>temperature</th>
      <th>humidity</th>
    </tr>
    <tr>
      <th>npartitions=1</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: from-delayed, 3 tasks</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">df</span></code>는 데이터프레임과 유사하지만 실제로 데이터를 메모리에 읽지 않았기 때문에 값은 표시되지 않는다.</p>
<p><code class="docutils literal notranslate"><span class="pre">head</span></code>, <code class="docutils literal notranslate"><span class="pre">tail</span></code> 명령을 내리면 그 때서야 일부 데이터를 읽어서 표시한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>temperature</th>
      <th>humidity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>22</td>
      <td>58</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>21</td>
      <td>57</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>25</td>
      <td>57</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>26</td>
      <td>55</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>22</td>
      <td>53</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>temperature 열의 평균을 구해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dd.Scalar&lt;series-..., dtype=float64&gt;
</pre></div>
</div>
</div>
</div>
<p>데이터프레임과 달리 바로 결과가 나오지 않는다. 그 이유는 연산 반환값이 결과가 아닌 작업(task)이기 때문이다. 구체적으로 어떤 작업인지를 보려면 <code class="docutils literal notranslate"><span class="pre">visualize</span></code> 메서드를 사용하여 작업 그래프(graph)를 볼 수 있다. 작업 그래프란 이 계산을 하기 위해 실제로 CPU가 해야 할 일들의 순서도라고 볼 수 있다.</p>
<p>이 작업의 값을 실제로 구하려면 결과로 받은 작업 객체의 <code class="docutils literal notranslate"><span class="pre">compute</span></code> 메서드를 호출해야 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>23.166666666666668
</pre></div>
</div>
</div>
</div>
<p>이번에는 이 값을 화씨로 변환해 보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">temperature</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    71.6
1    69.8
2    77.0
3    78.8
4    71.6
5    73.4
Name: temperature, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>이번에는 이 값으로 원래의 temperature 열을 갱신해보자. 이 때는 Pandas의 문법을 쓰지 못하고 다음과 같이 <code class="docutils literal notranslate"><span class="pre">assign</span></code> 메서드를 사용해야 한다. <code class="docutils literal notranslate"><span class="pre">assign</span></code> 메서드를 사용할 때는 <code class="docutils literal notranslate"><span class="pre">compute</span></code>를 할 필요가 없다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">temperature</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>temperature</th>
      <th>humidity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>71.6</td>
      <td>58</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>69.8</td>
      <td>57</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>77.0</td>
      <td>57</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>78.8</td>
      <td>55</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>71.6</td>
      <td>53</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>자료형을 변환하거나 새로운 열을 추가하는 것도 가능하다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; degree&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>temperature</th>
      <th>humidity</th>
      <th>title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>71.6</td>
      <td>58</td>
      <td>71.6 degree</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>69.8</td>
      <td>57</td>
      <td>69.8 degree</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>77.0</td>
      <td>57</td>
      <td>77.0 degree</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>78.8</td>
      <td>55</td>
      <td>78.8 degree</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>71.6</td>
      <td>53</td>
      <td>71.6 degree</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="id2">
<h2>복수 데이터에 대한 가상 데이터프레임<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Dask의 가상 데이터프레임이므로 원천 데이터 파일을 하나가 아닌 복수로 설정할 수도 있다. 예를 들어 앞서 보았던 <code class="docutils literal notranslate"><span class="pre">data1.csv</span></code> 파일 이외에도 다음과 같이 <code class="docutils literal notranslate"><span class="pre">data2.csv',</span> <span class="pre">'data3.csv</span></code> 파일이 있을 경우, 이 파일을 한 번에 하나의 데이터프레임으로 읽어들일 수도 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> data2.csv
<span class="n">time</span><span class="p">,</span><span class="n">temperature</span><span class="p">,</span><span class="n">humidity</span>
<span class="mi">0</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">58</span>
<span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">57</span>
<span class="mi">2</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">57</span>
<span class="mi">3</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">55</span>
<span class="mi">4</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">53</span>
<span class="mi">5</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">59</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing data2.csv
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> data3.csv
<span class="n">time</span><span class="p">,</span><span class="n">temperature</span><span class="p">,</span><span class="n">humidity</span>
<span class="mi">0</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">58</span>
<span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">57</span>
<span class="mi">2</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">57</span>
<span class="mi">3</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">55</span>
<span class="mi">4</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">53</span>
<span class="mi">5</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">59</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing data3.csv
</pre></div>
</div>
</div>
</div>
<p>복수 파일은 와일드카드(<code class="docutils literal notranslate"><span class="pre">*</span></code>) 기호를 이용하여 읽는다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data*.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time           18
temperature    18
humidity       18
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">temperature</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    18.000000
mean     23.166667
std       1.823055
min      21.000000
25%      22.000000
50%      22.500000
75%      24.500000
max      26.000000
dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h2>대량 데이터의 병렬 처리<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>이번에는 Dask로 대량의 데이터를 처리해보자. 샘플로 쓸 데이터는 미국 정부가 발표하는 공개 정보 중 하나로 시카고의 범죄 관련 데이터이다.</p>
<ul class="simple">
<li><p>https://catalog.data.gov/dataset/crimes-2001-to-present-398a4</p></li>
</ul>
<p>다음 명령으로 이 데이터를 다운로드 받을 수 있다. CSV 파일의 크기가 1.3GB가 넘으므로 다운로드에 10분 이상이 걸릴 수도 있다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!wget -O crime.csv https://data.cityofchicago.org/api/views/ijzp-q8t2/rows.csv?accessType=DOWNLOAD
</pre></div>
</div>
<p>파일을 다운로드 받은 후에는 가상 데이터프레임으로 읽어들인다. 구체적인 데이터를 아직 모르기 때문에 우선 문자열 자료형으로 읽어들인다. 또 <code class="docutils literal notranslate"><span class="pre">error_bad_lines</span></code> 옵션을 <code class="docutils literal notranslate"><span class="pre">False</span></code>로 해서 오류가 나는 데이터는 생략하도록 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;crime.csv&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn_bad_lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Case Number</th>
      <th>Date</th>
      <th>Block</th>
      <th>IUCR</th>
      <th>Primary Type</th>
      <th>Description</th>
      <th>Location Description</th>
      <th>Arrest</th>
      <th>Domestic</th>
      <th>Beat</th>
      <th>District</th>
      <th>Ward</th>
      <th>Community Area</th>
      <th>FBI Code</th>
      <th>X Coordinate</th>
      <th>Y Coordinate</th>
      <th>Year</th>
      <th>Updated On</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
    </tr>
    <tr>
      <th>npartitions=25</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: from-delayed, 75 tasks</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Case Number</th>
      <th>Date</th>
      <th>Block</th>
      <th>IUCR</th>
      <th>Primary Type</th>
      <th>Description</th>
      <th>Location Description</th>
      <th>Arrest</th>
      <th>Domestic</th>
      <th>...</th>
      <th>Ward</th>
      <th>Community Area</th>
      <th>FBI Code</th>
      <th>X Coordinate</th>
      <th>Y Coordinate</th>
      <th>Year</th>
      <th>Updated On</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>249058</th>
      <td>11536936</td>
      <td>JB555516</td>
      <td>11/22/2018 12:00:00 AM</td>
      <td>011XX S MAYFIELD AVE</td>
      <td>1150</td>
      <td>DECEPTIVE PRACTICE</td>
      <td>CREDIT CARD FRAUD</td>
      <td>RESIDENCE</td>
      <td>false</td>
      <td>false</td>
      <td>...</td>
      <td>29</td>
      <td>25</td>
      <td>11</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2018</td>
      <td>12/16/2018 04:11:17 PM</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>249059</th>
      <td>11536944</td>
      <td>JB555455</td>
      <td>12/07/2018 09:00:00 PM</td>
      <td>112XX S PARNELL AVE</td>
      <td>0486</td>
      <td>BATTERY</td>
      <td>DOMESTIC BATTERY SIMPLE</td>
      <td>APARTMENT</td>
      <td>false</td>
      <td>true</td>
      <td>...</td>
      <td>34</td>
      <td>49</td>
      <td>08B</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2018</td>
      <td>12/16/2018 04:11:17 PM</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>249060</th>
      <td>11536948</td>
      <td>JB555563</td>
      <td>12/07/2018 06:00:00 PM</td>
      <td>083XX S PEORIA ST</td>
      <td>2826</td>
      <td>OTHER OFFENSE</td>
      <td>HARASSMENT BY ELECTRONIC MEANS</td>
      <td>RESIDENCE</td>
      <td>false</td>
      <td>false</td>
      <td>...</td>
      <td>21</td>
      <td>71</td>
      <td>26</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2018</td>
      <td>12/16/2018 04:11:17 PM</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>249061</th>
      <td>24343</td>
      <td>JB545894</td>
      <td>12/09/2018 04:33:00 AM</td>
      <td>021XX N MULLIGAN AVE</td>
      <td>0110</td>
      <td>HOMICIDE</td>
      <td>FIRST DEGREE MURDER</td>
      <td>PORCH</td>
      <td>false</td>
      <td>false</td>
      <td>...</td>
      <td>36</td>
      <td>19</td>
      <td>01A</td>
      <td>1133729</td>
      <td>1913666</td>
      <td>2018</td>
      <td>12/16/2018 04:11:17 PM</td>
      <td>41.91931247</td>
      <td>-87.784093821</td>
      <td>(41.91931247, -87.784093821)</td>
    </tr>
    <tr>
      <th>249062</th>
      <td>24344</td>
      <td>JB546735</td>
      <td>12/09/2018 08:49:00 PM</td>
      <td>026XX S HOMAN AVE</td>
      <td>0110</td>
      <td>HOMICIDE</td>
      <td>FIRST DEGREE MURDER</td>
      <td>STREET</td>
      <td>false</td>
      <td>false</td>
      <td>...</td>
      <td>22</td>
      <td>30</td>
      <td>01A</td>
      <td>1154122</td>
      <td>1886317</td>
      <td>2018</td>
      <td>12/16/2018 04:11:17 PM</td>
      <td>41.843881174</td>
      <td>-87.709896602</td>
      <td>(41.843881174, -87.709896602)</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<p>이제 이 데이터프레임으로 분석을 시작하자. 데이터의 크기가 큰 만큼 시간이 오래 걸리기 때문에 Dask는 작업 진행도를 알 수 있는 <code class="docutils literal notranslate"><span class="pre">ProgressBar</span></code>란 것을 제공한다. 다음과 같이 <code class="docutils literal notranslate"><span class="pre">ProgressBar</span></code>를 만들고 등록한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dask.diagnostics</span> <span class="kn">import</span> <span class="n">ProgressBar</span>

<span class="n">pbar</span> <span class="o">=</span> <span class="n">ProgressBar</span><span class="p">()</span>
<span class="n">pbar</span><span class="o">.</span><span class="n">register</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>일단 등록하면 작업의 진행도를 프로그레스 바 형태로 알려준다. 우선 각 열의 데이터 갯수를 세어보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[########################################] | 100% Completed | 38.8s
CPU times: user 42.4 s, sys: 5.41 s, total: 47.8 s
Wall time: 38.8 s
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ID                      6766422
Case Number             6766418
Date                    6766422
Block                   6766422
IUCR                    6766422
Primary Type            6766422
Description             6766422
Location Description    6762210
Arrest                  6766422
Domestic                6766422
Beat                    6766422
District                6766375
Ward                    6151568
Community Area          6150393
FBI Code                6766422
X Coordinate            6705637
Y Coordinate            6705637
Year                    6766422
Updated On              6766422
Latitude                6705637
Longitude               6705637
Location                6705637
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>각 열의 데이터 수를 세는 데만도 50초가 넘는 시간이 걸렸다.</p>
<p>Dask는 이러한 대량 데이터의 분석 작업을 돕기 위한 작업 스케줄러(task scheduler)라는 것을 제공한다. 작업 스케줄러는 하나의 작업을 여러개의 쓰레드, 프로세스, 노드 등이 나누어 분담하도록 한다.</p>
<p>현재 Dask에서 제공하는 스케줄러의 종류는 다음과 같다.</p>
<ul class="simple">
<li><p>dask.get: 단일 쓰레드</p></li>
<li><p>dask.threaded.get: 멀티쓰레드 풀(pool)</p></li>
<li><p>dask.multiprocessing.get: 멀티프로세스 풀</p></li>
<li><p>distributed.Client.get: 여러대의 컴퓨터에서 분산 처리</p></li>
</ul>
<p>병렬처리를 위해서는 어떠한 병렬 처리 방식을 사용할지, 작업 프로세스의 갯수는 어떻게 할지 등은 <code class="docutils literal notranslate"><span class="pre">compute</span></code> 명령에서 인수로 설정해야 한다. 다음 코드는 멀티프로세싱을 하고 4개의 CPU 코어를 동시에 사용하도록 설정한 예이다. (물론 이 코드가 실행되는 컴퓨터가 실제로 4개 이상의 코어를 가지고 있어야 성능이 개선된다.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;processes&#39;</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[########################################] | 100% Completed | 17.1s
CPU times: user 450 ms, sys: 180 ms, total: 630 ms
Wall time: 17.2 s
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ID                      6766422
Case Number             6766418
Date                    6766422
Block                   6766422
IUCR                    6766422
Primary Type            6766422
Description             6766422
Location Description    6762210
Arrest                  6766422
Domestic                6766422
Beat                    6766422
District                6766375
Ward                    6151568
Community Area          6150393
FBI Code                6766422
X Coordinate            6705637
Y Coordinate            6705637
Year                    6766422
Updated On              6766422
Latitude                6705637
Longitude               6705637
Location                6705637
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>이번에는 처리 속도가 3배 이상 빨라졌음을 확인할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>rm data?.csv
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./01 python"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="04.08 시계열 자료 다루기.html" title="previous page">시계열 자료 다루기</a>
    <a class='right-next' id="next-link" href="05.01 시각화 패키지 Matplotlib 소개.html" title="next page">시각화 패키지 Matplotlib 소개</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By 김도형<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>