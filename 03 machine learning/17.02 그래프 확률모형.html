

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>그래프 확률모형 &#8212; 데이터 사이언스 스쿨</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "datascienceschool/book");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="네트워크 추론" href="17.03 네트워크 추론.html" />
    <link rel="prev" title="그래프 이론 기초" href="17.01 그래프 이론 기초.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">데이터 사이언스 스쿨</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   데이터 사이언스 스쿨
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  파이썬 편
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/00.00 소개의 글.html">
   소개의 글
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/01.00 1장 파이썬 설치와 설정.html">
   1장 파이썬 설치와 설정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.00 2장 파이썬 기초 문법.html">
   2장 파이썬 기초문법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/03.00 3장 넘파이 배열 프로그래밍.html">
   3장 넘파이 배열 프로그래밍
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.00 4장 판다스 데이터 분석.html">
   4장 판다스 데이터 분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/05.00 5장 데이터 시각화.html">
   5장 데이터 시각화
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  수학 편
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/01.00 1장 수학 기호.html">
   1장 수학 기호
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/02.00 2장 넘파이(NumPy)로 공부하는 선형대수.html">
   2장 넘파이(NumPy)로 공부하는 선형대수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/03.00 3장 고급 선형대수.html">
   3장 고급 선형대수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/04.00 4장 심파이(SymPy)로 공부하는 미적분.html">
   4장 심파이(SymPy)로 공부하는 미적분
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/05.00 5장 사이파이(SciPy)로 공부하는 최적화.html">
   5장 사이파이(SciPy)로 공부하는 최적화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/06.00 6장 피지엠파이(pgmpy)로 공부하는 확률론.html">
   6장 피지엠파이(pgmpy)로 공부하는 확률론
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/07.00 7장 확률변수와 상관관계.html">
   7장 확률변수와 상관관계
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/08.00 8장 사이파이로 공부하는 확률분포.html">
   8장 사이파이로 공부하는 확률분포
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/09.00 9장 추정과 검정.html">
   9장 추정과 검정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/10.00 10장 엔트로피.html">
   10장 엔트로피
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  머신러닝 편
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01.01 데이터 분석의 소개.html">
   1.1 데이터 분석의 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.02 머신러닝용 파이썬 패키지.html">
   1.2 머신러닝용 파이썬 패키지
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.01 데이터 전처리 기초.html">
   2.1 데이터 전처리 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.02 범주형 데이터 처리.html">
   2.2 범주형 데이터 처리
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.01 NLTK 자연어 처리 패키지.html">
   NLTK 자연어 처리 패키지
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.02 KoNLPy 한국어 처리 패키지.html">
   KoNLPy 한국어 처리 패키지
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.03 Scikit-Learn의 문서 전처리 기능.html">
   Scikit-Learn의 문서 전처리 기능
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.04 soynlp.html">
   Soynlp 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.05 확률론적 언어 모형.html">
   확률론적 언어 모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.01 이미지 처리 기초.html">
   이미지 처리 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.02 이미지 필터링.html">
   이미지 필터링
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.03 이미지 컨투어.html">
   이미지 컨투어
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.04 이미지 변환.html">
   이미지 변환
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.05 이미지 특징 추출.html">
   이미지 특징 추출
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.03.01 사운드 프로세싱 기초.html">
   사운드 프로세싱 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.03.02 푸리에 변환과 스펙트럼.html">
   푸리에 변환과 스펙트럼
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.04.01 지리 정보 데이터 처리.html">
   지리 정보 데이터 처리
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.04.02 지오코딩.html">
   Geocoding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.01 회귀분석 예제.html">
   4.1 회귀분석 예제
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.02 선형회귀분석의 기초.html">
   4.2 선형회귀분석의 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.03 스케일링.html">
   4.3 스케일링
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.04 범주형 독립변수.html">
   4.4 범주형 독립변수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.05 부분회귀.html">
   4.5 부분회귀
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.01 확률론적 선형 회귀모형.html">
   5.1 확률론적 선형 회귀모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.02 회귀분석의 기하학.html">
   5.2 회귀분석의 기하학
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.03 레버리지와 아웃라이어.html">
   5.3 레버리지와 아웃라이어
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.04 분산 분석과 모형 성능.html">
   5.4 분산 분석과 모형 성능
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 모형 진단과 수정.html">
   6.1 모형 진단과 수정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 모형 진단과 수정.html#id2">
   잔차 정규성
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 모형 진단과 수정.html#id3">
   잔차와 독립 변수의 관계
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 모형 진단과 수정.html#id4">
   이분산성
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 모형 진단과 수정.html#id5">
   자기 상관 계수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.02 기저함수 모형과 과최적화.html">
   6.2 기저함수 모형과 과최적화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.03 교차검증.html">
   6.3 교차검증
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.04 다중공선성과 변수 선택.html">
   6.4 다중공선성과 변수 선택
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.04 다중공선성과 변수 선택.html#vif">
   VIF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.04 다중공선성과 변수 선택.html#id2">
   보스턴 집값 예측 문제에 응용
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.05 정규화 선형회귀.html">
   6.5 정규화 선형회귀
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07.01 추천 시스템.html">
   13.1 추천 시스템
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.01 분류용 예제 데이터.html">
   5.1 분류용 예제 데이터
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 분류용 가상 데이터 생성.html">
   5.2 분류용 가상 데이터 생성
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 분류용 가상 데이터 생성.html#make-blobs">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_blobs
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 분류용 가상 데이터 생성.html#make-moons">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_moons
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 분류용 가상 데이터 생성.html#make-gaussian-quantiles">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_gaussian_quantiles
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.03 분류모형.html">
   5.3 분류모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.04 분류 성능평가.html">
   5.4 분류 성능평가
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10.01 로지스틱 회귀분석.html">
   6.1 로지스틱 회귀분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.01 선형판별분석법과 이차판별분석법.html">
   7.1 선형판별분석법과 이차판별분석법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.02 나이브베이즈 분류모형.html">
   7.2 나이브베이즈 분류모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.03 감성 분석.html">
   감성 분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.01 의사결정나무.html">
   8.1 의사결정나무
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.02 모형 결합.html">
   12.02 모형 결합
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.03 부스팅 방법.html">
   부스팅 방법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13.02 서포트 벡터 머신.html">
   서포트 벡터 머신
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13.03 커널 서포트 벡터 머신.html">
   커널 서포트 벡터 머신
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.01 모형 최적화.html">
   모형 최적화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.02 비대칭 데이터 문제.html">
   비대칭 데이터 문제
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.03 특징 선택.html">
   특징 선택
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.04 대규모 데이터 학습.html">
   대규모 데이터 학습
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.01 군집화.html">
   군집화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.02 K-평균 군집화.html">
   K-평균 군집화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.03 디비스캔 군집화.html">
   디비스캔 군집화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.04 계층적 군집화.html">
   계층적 군집화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.05 Affinity Propagation.html">
   Affinity Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.01 그래프 이론 기초.html">
   그래프 이론 기초
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   그래프 확률모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.03 네트워크 추론.html">
   네트워크 추론
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18.01 가우시안 혼합모형과 EM 방법.html">
   가우시안 혼합모형과 EM 방법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18.02 변분법적 추론.html">
   변분법적 추론
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19.01 몬테카를로 베이지안 분석.html">
   몬테카를로 베이지안 분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19.02 베이지안 회귀 분석 예제.html">
   베이지안 회귀 분석 예제
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="20.01 히든 마코프 모형.html">
   히든 마코프 모형
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/03 machine learning/17.02 그래프 확률모형.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/03 machine learning/17.02 그래프 확률모형.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/03 machine learning/17.02 그래프 확률모형.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   베이지안 네트워크 모형
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   베이지안 네트워크의 결합확률분포
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   조건부 독립
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   방향성 분리
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     꼬리-꼬리 결합
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     머리-꼬리 결합
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     머리-머리 결합
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   마코프 네트워크
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   클리크와 팩터
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id11">
   마코프 네트워크의 확률분포
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id12">
   에너지 함수
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id13">
   이미지 완성
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>그래프 확률모형<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>여러 확률변수의 결합분포를 구해야 하는 경우를 생각하자. 예를 들어 A, B, C, 3개의 확률변수가 있고 각 확률변수가 0, 1, 2 세가지의 값만 가질 수 있는 카테고리 확률변수인 경우 이 세 확률변수의 결합분포는 다음과 같이 표로 나타낼 수 있다. 이 표는 <span class="math notranslate nohighlight">\(3^3-1=26\)</span>개의 모수를 가지므로 (합이 1이 되어야 하므로 하나는 다른 값들에 의존한다.) 이 표를 저장하라면 26개의 저장 공간이 필요하다.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>A</p></th>
<th class="head"><p>B</p></th>
<th class="head"><p>C</p></th>
<th class="head"><p>P(A, B, C)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>P(A=0,B=0,C=0)</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>P(A=0,B=0,C=1)</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
<td><p>P(A=0,B=0,C=2)</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>P(A=0,B=1,C=0)</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>P(A=0,B=1,C=1)</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>P(A=0,B=1,C=2)</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>2</p></td>
<td><p>0</p></td>
<td><p>P(A=0,B=2,C=0)</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>P(A=0,B=2,C=1)</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>P(A=0,B=2,C=2)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>P(A=1,B=0,C=0)</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>P(A=1,B=0,C=1)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
<td><p>P(A=1,B=0,C=2)</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>P(A=1,B=1,C=0)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>P(A=1,B=1,C=1)</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>P(A=1,B=1,C=2)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>2</p></td>
<td><p>0</p></td>
<td><p>P(A=1,B=2,C=0)</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>P(A=1,B=2,C=1)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>P(A=1,B=2,C=2)</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>P(A=2,B=0,C=0)</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>P(A=2,B=0,C=1)</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
<td><p>P(A=2,B=0,C=2)</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>P(A=2,B=1,C=0)</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>P(A=2,B=1,C=1)</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>P(A=2,B=1,C=2)</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>2</p></td>
<td><p>0</p></td>
<td><p>P(A=2,B=2,C=0)</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>P(A=2,B=2,C=1)</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>P(A=2,B=2,C=2)</p></td>
</tr>
</tbody>
</table>
<div class="section" id="id2">
<h2>베이지안 네트워크 모형<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>그런데 현실에서는 모든 확률변수가 서로 영향을 미치는 복잡한 경우 보다 특정한 몇개의 확률분포들이 서로 영향을 미친다. 예를 들어 A, B, C가 각각 어떤 학생의</p>
<ul class="simple">
<li><p>A: 건강 상태</p></li>
<li><p>B: 공부 시간</p></li>
<li><p>C: 시험 성적</p></li>
</ul>
<p>을 나타낸 것이라고 하자. 이 확률변수는 각각 <span class="math notranslate nohighlight">\(\{0, 1, 2\}\)</span>라는 값을 가질 수 있는데 하(0), 중(1), 상(2)의 상태를 나타낸다.
즉 <span class="math notranslate nohighlight">\(A=0\)</span>이면 건강 상태가 안좋은 것이고 <span class="math notranslate nohighlight">\(B=1\)</span>이면 공부 시간이 보통이며 <span class="math notranslate nohighlight">\(C=2\)</span>이면 시험 성적이 좋은 것이다.</p>
<p>공부 시간 <span class="math notranslate nohighlight">\(B\)</span>는 시험 성적 <span class="math notranslate nohighlight">\(C\)</span>에 영향을 미친다. 하지만 건강 상태 <span class="math notranslate nohighlight">\(A\)</span>는 공부 시간 <span class="math notranslate nohighlight">\(B\)</span>와 인과 관계가 있지만 시험 성적 <span class="math notranslate nohighlight">\(C\)</span>와는 직접적인 인과 관계가 없다.
이렇게 다수의 확률변수 중 특정한 소수의 확률변수들이 가지는 관계를 그래프로 표현한 것을 그래프 확률모형(graphical probability model)이라고 하고 그래프 확률모형 중에서도 이렇게 인과관계가 확실하여 방향성 그래프로 표시할 수 있는 것을 베이지안 네트워크 모형이라고 한다. 위의 확률변수를 베이지안 네트워크 모형으로 그리면 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">networkx.drawing.nx_pydot</span> <span class="kn">import</span> <span class="n">to_pydot</span>

<span class="n">g1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_path</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">])</span>
<span class="n">d1</span> <span class="o">=</span> <span class="n">to_pydot</span><span class="p">(</span><span class="n">g1</span><span class="p">)</span>
<span class="n">d1</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">d1</span><span class="o">.</span><span class="n">set_rankdir</span><span class="p">(</span><span class="s2">&quot;LR&quot;</span><span class="p">)</span>
<span class="n">d1</span><span class="o">.</span><span class="n">set_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">create_png</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17.02 그래프 확률모형_4_0.png" src="../_images/17.02 그래프 확률모형_4_0.png" />
</div>
</div>
<p>이러한 그래프를 방향성 그래프(directed graph)라고 한다. 방향성 그래프에서 확률변수는 하나의 노드(node) 또는 정점(vertex)로 나타내고 인과관계는 화살표 간선(edge, link)으로 나타낸다. 우리가 다루는 방향성 그래프는 화살표가 여러 확률변수를 거쳐 자기 자신에게 돌아오는 루프(loop)가 없는 DAG(Directed Acyclic Graph)모형이다.</p>
<p>방향성 그래프 모델에서는 원인과 결과가 되는 두 확률변수의 관계를 조건부 확률분포로 표현한다. 위의 모형에서처럼 A가 B의 원인이 된다면 이 두 확률변수의 관계를 <span class="math notranslate nohighlight">\(P(B|A)\)</span>로 나타내고 B가 C의 원인이 되므로 두 확률변수의 관계는 <span class="math notranslate nohighlight">\(P(C|B)\)</span>로 나타낸다.</p>
<p>그리고 전체 확률변수들간의 관계는 이러한 조건부 확률분포를 결합하여 나타낼 수 있다. 위의 그래프에서 전체 결합분포는 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[ P(A, B, C) = P(A)P(B|A)P(C|B) \]</div>
<p>단, 여기에서 유의해야 점은 A와 B는 직접적인 인과 관계가 없지만 상관관계는 있을 수 있다는 점이다. 예를 들어 A-B, B-C간의 관계가 모두 양의 상관관계이면 A가 커졌을 때 B도 커지고 따라서 C도 커지므로 A와 B가 양의 상관관계를 가지게 된다. A, B, C가 의미하는 바로 해석하면 건강 상태와 시험 성적은 직접적인 인과관계는 없지만 건강 상태가 좋을 때 공부 시간도 많아질 가능성이 높고 공부 시간이 많을 때 시험 성적이 좋아진다면 건강 상태와 시험 성적은 양의 상관관계를 가질 수 있다.</p>
<p>조건부확률분포를 표로 나타내면 다음과 같다.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>A</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P(A)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A=0</p></td>
<td><p><span class="math notranslate nohighlight">\(P(A=0)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>A=1</p></td>
<td><p><span class="math notranslate nohighlight">\(P(A=1)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>A=2</p></td>
<td><p><span class="math notranslate nohighlight">\(P(A=2)\)</span></p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>B\A</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P(B\vert A=0)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P(B\vert A=1)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P(B\vert A=2)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>B=0</p></td>
<td><p><span class="math notranslate nohighlight">\(P(B=0\vert A=0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(B=0\vert A=1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(B=0\vert A=2)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>B=1</p></td>
<td><p><span class="math notranslate nohighlight">\(P(B=1\vert A=0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(B=1\vert A=1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(B=1\vert A=2)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>B=2</p></td>
<td><p><span class="math notranslate nohighlight">\(P(B=2\vert A=0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(B=2\vert A=1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(B=2\vert A=2)\)</span></p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>C\B</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P(C\vert B=0)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P(C\vert B=1)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P(C\vert B=2)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>C=0</p></td>
<td><p><span class="math notranslate nohighlight">\(P(C=0\vert B=0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(C=0\vert B=1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(C=0\vert B=2)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>C=1</p></td>
<td><p><span class="math notranslate nohighlight">\(P(C=1\vert B=0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(C=1\vert B=1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(C=1\vert B=2)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>C=2</p></td>
<td><p><span class="math notranslate nohighlight">\(P(C=2\vert B=0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(C=2\vert B=1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(P(C=2\vert B=2)\)</span></p></td>
</tr>
</tbody>
</table>
<p>이 경우에 우리가 알아야 하는 모수의 수는</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(A)\)</span>: <span class="math notranslate nohighlight">\(3-1=2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(B|A)\)</span>: <span class="math notranslate nohighlight">\((3-1)\times 2=6\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(C|B)\)</span>: <span class="math notranslate nohighlight">\((3-1)\times 2=6\)</span></p></li>
</ul>
<p>따라서 총 <span class="math notranslate nohighlight">\(14\)</span>개이다. 변수간의 인과 관계라는 추가 정보로 인해 모수의 숫자가 <span class="math notranslate nohighlight">\(26\)</span>개에서 <span class="math notranslate nohighlight">\(14\)</span>개로 크게 감소하였다. 이렇게 우리가 알고 있는 확률변수간의 정보를 그래프를 이용하여 추가하면 문제를 더 간단하게 만들 수 있다.</p>
<p>pgmpy 패키지에서는 <code class="docutils literal notranslate"><span class="pre">TabularCPD</span></code> 클래스로 조건부확률분포를 구현할 수 있다.
위 예제의 조건부확률분포 <span class="math notranslate nohighlight">\(P(A), P(B|A), P(C|B)\)</span>를 파이썬으로 구현해 보자. 우선 건강 상태는 나쁠(A=0) 확률이 20%, 보통(A=1)일 확률이 60%, 좋을 확률이 20%라고 하자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>

<span class="n">P_A</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P_A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----+-----+
| A_0 | 0.1 |
+-----+-----+
| A_1 | 0.6 |
+-----+-----+
| A_2 | 0.3 |
+-----+-----+
</pre></div>
</div>
</div>
</div>
<p>건강 상태 조건 A에 따른 공부시간 B의 확률분포는 다음과 같다.</p>
<ul class="simple">
<li><p>건강 상태가 나쁘면(A=0), 공부시간이 적거나(B=0), 보통이거나(B=1), 많을(B=2) 확률은 각각 60%, 30%, 10%다.</p></li>
<li><p>건강 상태가 보통이면(A=1), 공부시간이 적거나(B=0), 보통이거나(B=1), 많을(B=2) 확률은 각각 20%, 60%, 20%다.</p></li>
<li><p>건강 상태가 좋으면(A=2), 공부시간이 적거나(B=0), 보통이거나(B=1), 많을(B=2) 확률은 각각 20%, 30%, 50%다.</p></li>
</ul>
<p>확률분포값 행렬의 모양에 주의하라. 같은 조건의 확률은 같은 행이 아닌 같은 열에 들어간다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_B_I_A</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> 
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]]),</span>
    <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P_B_I_A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----+-----+-----+-----+
| A   | A_0 | A_1 | A_2 |
+-----+-----+-----+-----+
| B_0 | 0.6 | 0.2 | 0.2 |
+-----+-----+-----+-----+
| B_1 | 0.3 | 0.5 | 0.2 |
+-----+-----+-----+-----+
| B_2 | 0.1 | 0.3 | 0.6 |
+-----+-----+-----+-----+
</pre></div>
</div>
</div>
</div>
<p>CPD 객체는 <code class="docutils literal notranslate"><span class="pre">marginalize</span></code> 메서드로 특정 변수의 모든 경우의 확률을 더하는 sum-out을 할 수 있다.</p>
<div class="math notranslate nohighlight">
\[ P(B) = \sum_A P(A,B) = \sum_A P(B|A)P(A) \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">P_B_I_A</span> <span class="o">*</span> <span class="n">P_A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----+----------------------+------+------+
| A   | A_0                  | A_1  | A_2  |
+-----+----------------------+------+------+
| B_0 | 0.06                 | 0.12 | 0.06 |
+-----+----------------------+------+------+
| B_1 | 0.03                 | 0.3  | 0.06 |
+-----+----------------------+------+------+
| B_2 | 0.010000000000000002 | 0.18 | 0.18 |
+-----+----------------------+------+------+
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_B</span> <span class="o">=</span> <span class="p">(</span><span class="n">P_B_I_A</span> <span class="o">*</span> <span class="n">P_A</span><span class="p">)</span><span class="o">.</span><span class="n">marginalize</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----+------+
| B_0 | 0.24 |
+-----+------+
| B_1 | 0.39 |
+-----+------+
| B_2 | 0.37 |
+-----+------+
</pre></div>
</div>
</div>
</div>
<p>공부시간 B에 따른 성적 C의 확률분포는 다음과 같다.</p>
<ul class="simple">
<li><p>공부시간이 적으면(B=0), 성적이 나쁘거나(C=0), 보통이거나(C=1), 좋을(C=2) 확률은 각각 80%, 10%, 10%이다.</p></li>
<li><p>공부시간이 보통이면(B=1), 성적이 나쁘거나(C=0), 보통이거나(C=1), 좋을(C=2) 확률은 각각 10%, 80%, 10%이다.</p></li>
<li><p>공부시간이 많으면(B=2), 성적이 나쁘거나(C=0), 보통이거나(C=1), 좋을(C=2) 확률은 각각 10%, 10%, 80%이다.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_C_I_B</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> 
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]]),</span>
    <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P_C_I_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----+-----+-----+-----+
| B   | B_0 | B_1 | B_2 |
+-----+-----+-----+-----+
| C_0 | 0.8 | 0.1 | 0.1 |
+-----+-----+-----+-----+
| C_1 | 0.1 | 0.8 | 0.1 |
+-----+-----+-----+-----+
| C_2 | 0.1 | 0.1 | 0.8 |
+-----+-----+-----+-----+
</pre></div>
</div>
</div>
</div>
<p>마찬가지로 B를 marginalize하여 없애면 C에 대한 확률만 남는다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_C</span> <span class="o">=</span> <span class="p">(</span><span class="n">P_C_I_B</span> <span class="o">*</span> <span class="n">P_B</span><span class="p">)</span><span class="o">.</span><span class="n">marginalize</span><span class="p">([</span><span class="s2">&quot;B&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P_C</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----+-------+
| C_0 | 0.268 |
+-----+-------+
| C_1 | 0.373 |
+-----+-------+
| C_2 | 0.359 |
+-----+-------+
</pre></div>
</div>
</div>
</div>
<p>이 조건부 확률들을 결합하여 하나의 베이지안 네트워크로 만들려면 <code class="docutils literal notranslate"><span class="pre">BayesianModel</span></code> 클래스를 사용한다. 생성자에는 노드를 연결한 그래프 정보를 넣고 <code class="docutils literal notranslate"><span class="pre">add_cpds</span></code> 메서드로 조건부확률을 추가할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">BayesianModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)])</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">P_A</span><span class="p">,</span> <span class="n">P_B_I_A</span><span class="p">,</span> <span class="n">P_C_I_B</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">check_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>클래스 객체를 graphviz와 pydot 패키지로 시각화할 수도 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">networkx.drawing.nx_pydot</span> <span class="kn">import</span> <span class="n">to_pydot</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">to_pydot</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">set_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">set_rankdir</span><span class="p">(</span><span class="s2">&quot;LR&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">create_png</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17.02 그래프 확률모형_21_0.png" src="../_images/17.02 그래프 확률모형_21_0.png" />
</div>
</div>
<p>이렇게 만들어진 모형으로부터 여러가지 추론(inference)을 할 수 있다. 예를 들어 전체 결합확률분포 함수를 찾고 그 함수로부터 A, B, C의 marginal 확률분포를 계산하면 A, B, C의 값으로 어떤 값이 가장 확률이 높은지 알 수 있다. 분석 결과를 보면 시험 성적이 좋을 확률은 35.9%이다. 추론에 사용된 <code class="docutils literal notranslate"><span class="pre">VariableElimination</span></code> 클래스의 사용법에 대해서는 곧 학습한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----+----------+
| C   |   phi(C) |
+=====+==========+
| C_0 |   0.2680 |
+-----+----------+
| C_1 |   0.3730 |
+-----+----------+
| C_2 |   0.3590 |
+-----+----------+
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h2>베이지안 네트워크의 결합확률분포<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>베이지안 네트워크를 만들려면 조사 대상이 되는 확률변수를 노드(node)로 생성하고 인과관계가 있는 노드를 방향성 간선(directed edge)로 연결한다.
베이지안 네트워크를 구성하는 확률변수의 결합확률분포는 다음처럼 주어진다.</p>
<div class="math notranslate nohighlight">
\[ P(X_1, \cdots, X_N) = \prod_{i=1}^N P(X_i | Pa(X_i)) \]</div>
<p>이 식에서 <span class="math notranslate nohighlight">\(Pa(X_i)\)</span>는 <span class="math notranslate nohighlight">\(X_i\)</span>의 부모 노드이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X1&quot;</span><span class="p">,</span> <span class="s2">&quot;X3&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X1&quot;</span><span class="p">,</span> <span class="s2">&quot;X4&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X3&quot;</span><span class="p">,</span> <span class="s2">&quot;X4&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X2&quot;</span><span class="p">,</span> <span class="s2">&quot;X4&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X2&quot;</span><span class="p">,</span> <span class="s2">&quot;X7&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X4&quot;</span><span class="p">,</span> <span class="s2">&quot;X5&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X4&quot;</span><span class="p">,</span> <span class="s2">&quot;X6&quot;</span><span class="p">)</span>

<span class="n">d1</span> <span class="o">=</span> <span class="n">to_pydot</span><span class="p">(</span><span class="n">g1</span><span class="p">)</span>
<span class="n">d1</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">d1</span><span class="o">.</span><span class="n">set_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">d1</span><span class="o">.</span><span class="n">set_rankdir</span><span class="p">(</span><span class="s2">&quot;LR&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">create_png</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17.02 그래프 확률모형_26_0.png" src="../_images/17.02 그래프 확률모형_26_0.png" />
</div>
</div>
<p>예를 들어 <span class="math notranslate nohighlight">\(X_1, \ldots, X_6\)</span>의 관계가 앞 그래프와 같다면 결합확률분포는 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[ P(X_1, X_2, X_3, X_4, X_5, X_6, X_7) = P(X_1) P(X_2) P(X_3 | X_1) P(X_4| X_1, X_2, X_3) P(X_5|X_4) P(X_6|X_4) P(X_7|X_2) \]</div>
</div>
<div class="section" id="id4">
<h2>조건부 독립<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>베이지안 네트워크를 만들 때 중요한 것은 확률변수간의 조건부 독립 관계가 그래프에 나타나고 있어야 한다는 점이다.</p>
<p>조건부 독립(conditional independence)은 일반적인 독립과 달리 조건이 되는 확률변수가 존재해야 한다.</p>
<p>일반적으로는 확률변수 A, B가 독립인 정의는 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[ P(A, B) = P(A)P(B) \]</div>
<p>조건부 독립은 조건이 되는 C라는 확률변수에 대한 조건부 결합확률분포에 대해 다음이 만족되어야 한다.</p>
<div class="math notranslate nohighlight">
\[ P(A, B|C) = P(A|C) P(B|C) \]</div>
<p>즉, C에 대한 조건부 결합확률분포가 조건부 확률분포의 곱으로 나타난다.</p>
<p>기호로는 다음과 같이 표기한다.</p>
<div class="math notranslate nohighlight">
\[ A \text{⫫} B \;\vert\; C \]</div>
<p>같은 방식으로 무조건부 독립은 다음과 같이 표기하도 한다.</p>
<div class="math notranslate nohighlight">
\[ A \text{⫫} B \;\vert\; \emptyset \]</div>
<p>A, B가 C에 대해 조건부 독립이면 다음도 만족한다.</p>
<div class="math notranslate nohighlight">
\[ P(A|B,C) = P(A|C) \]</div>
<div class="math notranslate nohighlight">
\[ P(B|A,C) = P(B|C) \]</div>
<p>주의할 점은 조건부 독립과 (무조건부) 독립은 관계가 없다는 점이다. 즉, 두 확률변수가 독립이라고 항상 조건부 독립이 되는 것도 아니고 조건부 독립이라고 꼭 독립이 되는 것도 아니다.</p>
<div class="math notranslate nohighlight">
\[ P(A,B) = P(A)P(B) \;\; \bcancel{\implies} \;\; P(A,B|C) = P(A|C)P(B|C) \]</div>
<div class="math notranslate nohighlight">
\[  P(A,B|C) = P(A|C)P(B|C) \;\; \bcancel{\implies} \;\; P(A,B) = P(A)P(B) \]</div>
</div>
<div class="section" id="id5">
<h2>방향성 분리<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>방향성 분리(d-separation, directed separation) 정리는 방향성 그래프 모형에서 어떤 두 노드(확률변수)가 조건부 독립인지 아닌지 알아보는 방법이다. 다음과 같은 세가지 간선 결합을 알아야 한다.</p>
<ul class="simple">
<li><p>꼬리-꼬리 결합</p></li>
<li><p>머리-꼬리 결합</p></li>
<li><p>머리-머리 결합</p></li>
</ul>
<div class="section" id="id6">
<h3>꼬리-꼬리 결합<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>우선 다음과 같이 확률변수 A, B가 공통의 부모 C를 가지는 경우를 보자. C에서는 간선(화살표)의 꼬리가 2개 붙어 있기 때문에 C는 꼬리-꼬리(tail-to-tail ) 결합이라고 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">g2</span><span class="o">.</span><span class="n">add_path</span><span class="p">([</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">])</span>
<span class="n">g2</span><span class="o">.</span><span class="n">add_path</span><span class="p">([</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">])</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">to_pydot</span><span class="p">(</span><span class="n">g2</span><span class="p">)</span>
<span class="n">d2</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_fillcolor</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">d2</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;filled&quot;</span><span class="p">)</span>
<span class="n">d2</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">d2</span><span class="o">.</span><span class="n">set_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">d2</span><span class="o">.</span><span class="n">create_png</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17.02 그래프 확률모형_36_0.png" src="../_images/17.02 그래프 확률모형_36_0.png" />
</div>
</div>
<p>이 때 A와 B는 독립은 아니지만 조건부 독립이 성립한다.</p>
<div class="math notranslate nohighlight">
\[ P(A,B|C) = \dfrac{P(A, B, C)}{P(C)} = \dfrac{P(A|C)P(B|C)P(C)}{P(C)} = P(A|C)P(B|C) \]</div>
<p>즉 C가 어떤 값인지 알고 있을 때 A의 확률은 B의 값과 아무런 관계가 없다.</p>
</div>
<div class="section" id="id7">
<h3>머리-꼬리 결합<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>다음으로는 인과관계인 확률변수 A, B 사이에 C가 끼어 있는 경우를 살펴보자. 이때 노드 C에서 간선의 머리와 꼬리가 만나기 때문에 머리-꼬리(head-to-tail ) 결합이라고 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">g3</span><span class="o">.</span><span class="n">add_path</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">])</span>
<span class="n">d3</span> <span class="o">=</span> <span class="n">to_pydot</span><span class="p">(</span><span class="n">g3</span><span class="p">)</span>
<span class="n">d3</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">d3</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_fillcolor</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">d3</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;filled&quot;</span><span class="p">)</span>
<span class="n">d3</span><span class="o">.</span><span class="n">set_rankdir</span><span class="p">(</span><span class="s2">&quot;LR&quot;</span><span class="p">)</span>
<span class="n">d3</span><span class="o">.</span><span class="n">set_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">d3</span><span class="o">.</span><span class="n">create_png</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17.02 그래프 확률모형_40_0.png" src="../_images/17.02 그래프 확률모형_40_0.png" />
</div>
</div>
<p>이 경우에도 A와 B는 독립이 아니지만 조건부 독립이 성립한다.</p>
<div class="math notranslate nohighlight">
\[ P(A,B|C) = \dfrac{P(A, B, C)}{P(C)} = \dfrac{P(A)P(C|A)P(B|C)}{P(C)} = \dfrac{P(A,C)P(B|C)}{P(C)} = P(A|C)P(B|C) \]</div>
<p>즉 C가 어떤 값인지 알고 있을 때 A의 확률은 B의 값과 아무런 관계가 없다.</p>
</div>
<div class="section" id="id8">
<h3>머리-머리 결합<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>마지막으로 두 확률변수 A, B 를 부모로 가지는 C가 있는 경우를 살펴보자. 이러한 구조는 V-구조(V-structure) 또는 머리-머리(head-to-head) 결합이라고 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g4</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">g4</span><span class="o">.</span><span class="n">add_path</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">])</span>
<span class="n">g4</span><span class="o">.</span><span class="n">add_path</span><span class="p">([</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">])</span>
<span class="n">d4</span> <span class="o">=</span> <span class="n">to_pydot</span><span class="p">(</span><span class="n">g4</span><span class="p">)</span>
<span class="n">d4</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_fillcolor</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">d4</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;filled&quot;</span><span class="p">)</span>
<span class="n">d4</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">d4</span><span class="o">.</span><span class="n">set_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">d4</span><span class="o">.</span><span class="n">create_png</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17.02 그래프 확률모형_44_0.png" src="../_images/17.02 그래프 확률모형_44_0.png" />
</div>
</div>
<p>이 경우에는 앞의 두 경우와 달리 A와 B가 독립이다.</p>
<div class="math notranslate nohighlight">
\[ P(A,B,C) = P(A)P(B)P(C|A,B) \]</div>
<div class="math notranslate nohighlight">
\[ P(A,B) = \sum_c P(A)P(B)P(C|A,B) = P(A)P(B) \]</div>
<p>하지만 조건부 독립은 성립하지 않는다. 즉 C값을 알고 있다면 A와 B가 서로 종속관계가 된다.</p>
<p>예를 들어 A가 늦잠을 자는 것을 나타내는 확률변수, B가 길이 막히는 것을 나타내는 확률변수, C가 지각하는 것을 나타내는 확률변수라고 할 때, 늦잠을 자는 것과 길이 막히는 것은 서로 독립이다.</p>
<p>하지만 일단 지각(C)이 발생한 상황에서는 A, B는 서로 독립이 아니며 이 경우에는 반-상관관계를 가진다. 즉, 늦잠을 자지 않았다면 길이 막혔을 가능성이 높아지고 길이 막히지 않았다면 늦잠을 잤을 가능성이 높아진다. 이러한 것을 explaining-out이라고 한다.</p>
<p>이러한 상황은 C가 A, B의 직접적 자식이 아니라 후손(descendent)인 경우에도 성립한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g5</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">g5</span><span class="o">.</span><span class="n">add_path</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">])</span>
<span class="n">g5</span><span class="o">.</span><span class="n">add_path</span><span class="p">([</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">])</span>
<span class="n">g5</span><span class="o">.</span><span class="n">add_path</span><span class="p">([</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">])</span>
<span class="n">d5</span> <span class="o">=</span> <span class="n">to_pydot</span><span class="p">(</span><span class="n">g5</span><span class="p">)</span>
<span class="n">d5</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_fillcolor</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">d5</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;filled&quot;</span><span class="p">)</span>
<span class="n">d5</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">d5</span><span class="o">.</span><span class="n">set_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">d5</span><span class="o">.</span><span class="n">create_png</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17.02 그래프 확률모형_46_0.png" src="../_images/17.02 그래프 확률모형_46_0.png" />
</div>
</div>
<p>이상의 상황을 정리한 것이 바로 방향성 분리(d-separation) 정리이다. 방향성 분리(d-separation) 정리에 따르면 A와 B가 C에 대해서 조건부 독립인 경우는 다음 조건이 만족되어야 한다.</p>
<ol class="simple">
<li><p>C가 A, B 사이의 경로에 있는 꼬리-꼬리 결합이거나 머리-꼬리 결합이다.</p></li>
<li><p>C가 A, B 사이의 경로상에 있는 머리-머리 결합이거나 혹은 이러한 노드의 자손이 아니어야 한다.</p></li>
</ol>
</div>
</div>
<div class="section" id="id9">
<h2>마코프 네트워크<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>때로는 변수간의 인과관계가 순환(cycle)관계를 이루기 때문에 방향성이 있는 베이지안 네트워크로 구현할 수 없는 경우도 있다. 이 때는 무방향성 그래프(undirected graph)인 마코프 네트워크(Markov network)를 사용한다. 마코프 무작위장(Markov random field)라고도 한다.</p>
<p>예를 들어 3 x 3 이미지의 픽셀 9개의 값이 확률변수라고 하면 이 9개의 확률변수는 중 어떤 2개도 서로 관련성을 가진다. 이 때는 다음과 같은 마코프 네트워크를 사용할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">networkx.drawing.nx_pydot</span> <span class="kn">import</span> <span class="n">to_pydot</span>

<span class="n">g1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X11&quot;</span><span class="p">,</span> <span class="s2">&quot;X12&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X11&quot;</span><span class="p">,</span> <span class="s2">&quot;X21&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X12&quot;</span><span class="p">,</span> <span class="s2">&quot;X22&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X12&quot;</span><span class="p">,</span> <span class="s2">&quot;X13&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X21&quot;</span><span class="p">,</span> <span class="s2">&quot;X31&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X21&quot;</span><span class="p">,</span> <span class="s2">&quot;X22&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X22&quot;</span><span class="p">,</span> <span class="s2">&quot;X23&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X22&quot;</span><span class="p">,</span> <span class="s2">&quot;X32&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X31&quot;</span><span class="p">,</span> <span class="s2">&quot;X32&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X32&quot;</span><span class="p">,</span> <span class="s2">&quot;X33&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X13&quot;</span><span class="p">,</span> <span class="s2">&quot;X23&quot;</span><span class="p">)</span>
<span class="n">g1</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;X23&quot;</span><span class="p">,</span> <span class="s2">&quot;X33&quot;</span><span class="p">)</span>
<span class="n">d1</span> <span class="o">=</span> <span class="n">to_pydot</span><span class="p">(</span><span class="n">g1</span><span class="p">)</span>
<span class="n">d1</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">d1</span><span class="o">.</span><span class="n">set_margin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">d1</span><span class="o">.</span><span class="n">set_rankdir</span><span class="p">(</span><span class="s2">&quot;LR&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">create_png</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17.02 그래프 확률모형_50_0.png" src="../_images/17.02 그래프 확률모형_50_0.png" />
</div>
</div>
</div>
<div class="section" id="id10">
<h2>클리크와 팩터<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>마코프 네트워크는 클리크(clique)로 구성되는데 클리크를 구성하는 확률변수의 분포는 포텐셜 함수(potential function) 또는 팩터(factor)로 표현할 수 있다. 팩터는 가능한 모든 결과의 조합에 대한 실수함수다. 따라서 확률분포함수는 팩터의 일종이다. 하지만 팩터는 확률분포함수와 달리 모든 값을 더해서 1이 되어야 한다는 조건이 없다.</p>
<div class="math notranslate nohighlight">
\[ p(X, Y) = \dfrac{1}{Z}\psi_1(X, Y) \]</div>
<div class="math notranslate nohighlight">
\[ p(X | Y) = \dfrac{1}{Z}\psi_2(X, Y) \]</div>
<p>pgmpy는 팩터를 정의하는 <code class="docutils literal notranslate"><span class="pre">DiscreteFactor</span></code> 클래스를 제공한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.factors.discrete</span> <span class="kn">import</span> <span class="n">DiscreteFactor</span>

<span class="n">phi</span> <span class="o">=</span> <span class="n">DiscreteFactor</span><span class="p">([</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+------+------+------+-----------------+
| x1   | x2   | x3   |   phi(x1,x2,x3) |
+======+======+======+=================+
| x1_0 | x2_0 | x3_0 |          0.0000 |
+------+------+------+-----------------+
| x1_0 | x2_0 | x3_1 |          1.0000 |
+------+------+------+-----------------+
| x1_0 | x2_1 | x3_0 |          2.0000 |
+------+------+------+-----------------+
| x1_0 | x2_1 | x3_1 |          3.0000 |
+------+------+------+-----------------+
| x1_1 | x2_0 | x3_0 |          4.0000 |
+------+------+------+-----------------+
| x1_1 | x2_0 | x3_1 |          5.0000 |
+------+------+------+-----------------+
| x1_1 | x2_1 | x3_0 |          6.0000 |
+------+------+------+-----------------+
| x1_1 | x2_1 | x3_1 |          7.0000 |
+------+------+------+-----------------+
</pre></div>
</div>
</div>
</div>
<p>pgmpy의 CPD 결합분포 객체는 팩터로 변환하는 <code class="docutils literal notranslate"><span class="pre">to_factor</span></code> 메서드를 제공한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">P_B_I_A</span><span class="o">.</span><span class="n">to_factor</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----+-----+------------+
| B   | A   |   phi(B,A) |
+=====+=====+============+
| B_0 | A_0 |     0.6000 |
+-----+-----+------------+
| B_0 | A_1 |     0.2000 |
+-----+-----+------------+
| B_0 | A_2 |     0.2000 |
+-----+-----+------------+
| B_1 | A_0 |     0.3000 |
+-----+-----+------------+
| B_1 | A_1 |     0.5000 |
+-----+-----+------------+
| B_1 | A_2 |     0.2000 |
+-----+-----+------------+
| B_2 | A_0 |     0.1000 |
+-----+-----+------------+
| B_2 | A_1 |     0.3000 |
+-----+-----+------------+
| B_2 | A_2 |     0.6000 |
+-----+-----+------------+
</pre></div>
</div>
</div>
</div>
<p>factor 객체는 어떤 확률변수가 특정한 값을 가지는 경우만 추출하는 <code class="docutils literal notranslate"><span class="pre">reduce</span></code> 메서드를 제공한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">P_B_I_A</span><span class="o">.</span><span class="n">to_factor</span><span class="p">()</span><span class="o">.</span><span class="n">reduce</span><span class="p">([(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----+----------+
| A   |   phi(A) |
+=====+==========+
| A_0 |   0.6000 |
+-----+----------+
| A_1 |   0.2000 |
+-----+----------+
| A_2 |   0.2000 |
+-----+----------+
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">P_B_I_A</span><span class="o">.</span><span class="n">to_factor</span><span class="p">()</span><span class="o">.</span><span class="n">reduce</span><span class="p">([(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-----+----------+
| B   |   phi(B) |
+=====+==========+
| B_0 |   0.2000 |
+-----+----------+
| B_1 |   0.5000 |
+-----+----------+
| B_2 |   0.3000 |
+-----+----------+
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id11">
<h2>마코프 네트워크의 확률분포<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<p>마코프 네트워크의 결합확률분포는 마코프 네트워크를 구성하는 모든 클리크의 팩터의 곱으로 나타난다.</p>
<div class="math notranslate nohighlight">
\[ P(X) = \dfrac{1}{Z(X)} \prod_{\{C\}} \psi_C(X_C) \]</div>
<p>이 식에서 <span class="math notranslate nohighlight">\(C\)</span>는 클리크, <span class="math notranslate nohighlight">\(X_C\)</span>는 그 클리크 안의 확률변수, <span class="math notranslate nohighlight">\(\psi_C\)</span>는 그 클리크의 팩터, <span class="math notranslate nohighlight">\(\{C\}\)</span>는 모든 클리크의 집합, <span class="math notranslate nohighlight">\(Z\)</span>는 파티션 함수(partition)함수를 나타낸다.</p>
<p>예를 들어 3 x 3 이미지의 경우 9개의 확률변수의 결합확률분포는 다음처럼 표현할 수 있다.</p>
<div class="math notranslate nohighlight">
\[ 
P(X_{11}, \ldots, X_{33}) = 
\dfrac{1}{Z}
\prod 
\psi(X_{11}, X_{12}) 
\psi(X_{11}, X_{21}) 
\psi(X_{12}, X_{13}) 
\cdots
\psi(X_{23}, X_{33}) 
\psi(X_{32}, X_{33}) 
\]</div>
</div>
<div class="section" id="id12">
<h2>에너지 함수<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<p>팩터 함수는 다음과 같은 형태로 표시할 수 있다.</p>
<div class="math notranslate nohighlight">
\[ \psi(X) = \exp(−E(X)) \]</div>
<p>이 식에서 <span class="math notranslate nohighlight">\(E(X)\)</span>를 에너지 함수(energe function)라고 한다. 확률이 높을수록 에너지 함수의 값은 작아진다.</p>
<p>예를 들어 0과 1이라는 값을 가지는 베르누이 확률변수 <span class="math notranslate nohighlight">\(X_{1}, X_{2}\)</span>가 다음과 같은 에너지 함수로 표현되는 경우,</p>
<div class="math notranslate nohighlight">
\[ E(X_1, X_2) = -3(2X_1 - 1)(2X_2 - 1) \]</div>
<p>팩터의 값을 구하면</p>
<div class="math notranslate nohighlight">
\[ \psi(X_1 = 1, X_2 = 1) = e^3 \]</div>
<div class="math notranslate nohighlight">
\[ \psi(X_1 = 0, X_2 = 0) = e^3 \]</div>
<div class="math notranslate nohighlight">
\[ \psi(X_1 = 1, X_2 = 0) = e^{-3} \]</div>
<div class="math notranslate nohighlight">
\[ \psi(X_1 = 0, X_2 = 1) = e^{-3} \]</div>
<p>즉 <span class="math notranslate nohighlight">\(X_{1}, X_{2}\)</span> 둘 다 같은 값을 가질 확률은 서로 다른 값을 가질 확률에 비해 높아진다. 즉 서로 양의 상관관계를 가지게 된다.</p>
<p>pgmpy에서는 <code class="docutils literal notranslate"><span class="pre">MarkovModel</span></code> 클래스로 마코프 네트워크 모형을 구현한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">MarkovModel</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">ginfo</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">v1</span> <span class="o">=</span> <span class="s2">&quot;X</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="s2">&quot;X</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">ginfo</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">v1</span> <span class="o">=</span> <span class="s2">&quot;X</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="s2">&quot;X</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">ginfo</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">))</span>
            
<span class="n">model</span> <span class="o">=</span> <span class="n">MarkovModel</span><span class="p">(</span><span class="n">ginfo</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">to_pydot</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">set_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">set_rankdir</span><span class="p">(</span><span class="s2">&quot;LR&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">create_png</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17.02 그래프 확률모형_66_0.png" src="../_images/17.02 그래프 확률모형_66_0.png" />
</div>
</div>
<p>팩터는 <code class="docutils literal notranslate"><span class="pre">DiscreteFactor</span></code> 클래스로 구현할 수 있다. 예를 들어 <span class="math notranslate nohighlight">\(X_{11}, X_{12}\)</span>의 팩터함수가</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(X_{12}=0\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(X_{12}=1\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(X_{11}=0\)</span></p></td>
<td><p>10</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(X_{11}=1\)</span></p></td>
<td><p>1</p></td>
<td><p>10</p></td>
</tr>
</tbody>
</table>
<p>이면 다음처럼 구현한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.factors.discrete</span> <span class="kn">import</span> <span class="n">DiscreteFactor</span>

<span class="n">factor</span> <span class="o">=</span> <span class="n">DiscreteFactor</span><span class="p">([</span><span class="s1">&#39;X11&#39;</span><span class="p">,</span> <span class="s1">&#39;X12&#39;</span><span class="p">],</span> <span class="n">cardinality</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> 
                        <span class="n">values</span><span class="o">=</span><span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_factors</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id13">
<h2>이미지 완성<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<p>마코프 네트워크의 예로 다음과 같은 두 종류의 5x5 이미지 데이터를 생각하자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_char</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">images</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_char</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">idx</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> 
<span class="p">]))</span>
<span class="n">idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="p">]))</span>

<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">:</span>
        <span class="n">images</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_char</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_char</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">bone_r</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17.02 그래프 확률모형_71_0.png" src="../_images/17.02 그래프 확률모형_71_0.png" />
</div>
</div>
<p>다음과 같이 팩터 함수를 학습한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">MarkovModel</span>
<span class="kn">from</span> <span class="nn">pgmpy.factors.discrete</span> <span class="kn">import</span> <span class="n">DiscreteFactor</span>

<span class="k">def</span> <span class="nf">get_factor</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span><span class="p">):</span>
    <span class="n">p00</span> <span class="o">=</span> <span class="n">p01</span> <span class="o">=</span> <span class="n">p10</span> <span class="o">=</span> <span class="n">p11</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_images</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">images</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">images</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx2</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">p00</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">images</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">images</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx2</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">p01</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">images</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">images</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx2</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">p10</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">images</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">images</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx2</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">p11</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="n">DiscreteFactor</span><span class="p">([</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">],</span> <span class="n">cardinality</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> 
                <span class="n">values</span><span class="o">=</span><span class="p">[[</span><span class="n">p00</span><span class="p">,</span> <span class="n">p01</span><span class="p">],</span> <span class="p">[</span><span class="n">p10</span><span class="p">,</span> <span class="n">p11</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">factor</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MarkovModel</span><span class="p">()</span>

<span class="n">num_images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n1</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">n2</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">v1</span> <span class="o">=</span> <span class="s2">&quot;X</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="s2">&quot;X</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">model</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
            <span class="n">factor</span> <span class="o">=</span> <span class="n">get_factor</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">model</span><span class="o">.</span><span class="n">add_factors</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">v1</span> <span class="o">=</span> <span class="s2">&quot;X</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="s2">&quot;X</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">model</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
            <span class="n">factor</span> <span class="o">=</span> <span class="n">get_factor</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
            <span class="n">model</span><span class="o">.</span><span class="n">add_factors</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">check_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>학습된 팩터의 일부를 살펴보자. 일례로 <span class="math notranslate nohighlight">\(X_{11}\)</span>과 <span class="math notranslate nohighlight">\(X_{12}\)</span>의 결합확률 팩터는 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_factors</span><span class="p">(</span><span class="s2">&quot;X11&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;DiscreteFactor representing phi(X11:2, X12:2) at 0x7fb41b1b3710&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------+-------+----------------+
| X11   | X12   |   phi(X11,X12) |
+=======+=======+================+
| X11_0 | X12_0 |         0.0000 |
+-------+-------+----------------+
| X11_0 | X12_1 |         1.0000 |
+-------+-------+----------------+
| X11_1 | X12_0 |         1.0000 |
+-------+-------+----------------+
| X11_1 | X12_1 |         0.0000 |
+-------+-------+----------------+
</pre></div>
</div>
</div>
</div>
<p>다음은 전체 네트워크 모양이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">to_pydot</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">set_margin</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">set_rankdir</span><span class="p">(</span><span class="s2">&quot;LR&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">create_png</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17.02 그래프 확률모형_78_0.png" src="../_images/17.02 그래프 확률모형_78_0.png" />
</div>
</div>
<p>다음 코드는 이미지의 일부를 알고 있을 때 나머지 이미지를 추정한 결과이다. 코드에서 <code class="docutils literal notranslate"><span class="pre">evidence</span></code>는 관측된 이미지의 일부이다. 여기에서 사용하는 <code class="docutils literal notranslate"><span class="pre">BeliefPropagation</span></code> 클래스는 다음 절에서 공부한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.inference</span> <span class="kn">import</span> <span class="n">BeliefPropagation</span>
<span class="n">inference</span> <span class="o">=</span> <span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="nb">vars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
        <span class="nb">vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;X</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">evidence1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;X11&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;X21&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;X31&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;X41&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;X51&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;X15&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;X25&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;X35&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;X45&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;X55&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">evidence2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;X11&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;X21&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;X31&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;X41&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;X51&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;X15&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;X25&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;X35&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;X45&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;X55&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">evidence</span> <span class="o">=</span> <span class="n">evidence1</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">evidence</span><span class="p">:</span>
    <span class="nb">vars</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
<span class="n">result</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">map_query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="nb">vars</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="n">evidence</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">evidence</span><span class="p">)</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
        <span class="n">image</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;X</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 1. 1. 1. 0.]
 [1. 0. 0. 0. 1.]
 [1. 0. 1. 0. 1.]
 [1. 0. 0. 0. 1.]
 [0. 1. 1. 1. 0.]]
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./03 machine learning"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="17.01 그래프 이론 기초.html" title="previous page">그래프 이론 기초</a>
    <a class='right-next' id="next-link" href="17.03 네트워크 추론.html" title="next page">네트워크 추론</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By 김도형<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>