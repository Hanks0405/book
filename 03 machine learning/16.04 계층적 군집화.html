

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>계층적 군집화 &#8212; 데이터 사이언스 스쿨</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "datascienceschool/book");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Affinity Propagation" href="16.05 Affinity Propagation.html" />
    <link rel="prev" title="디비스캔 군집화" href="16.03 디비스캔 군집화.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">데이터 사이언스 스쿨</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   데이터 사이언스 스쿨
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  파이썬 편
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/01.01 커맨드 라인 인터페이스.html">
   1.1 커맨드 라인 인터페이스
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/01.02 파이썬 설치하기.html">
   1.2 파이썬 설치하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/01.03 파이썬 처음 사용하기.html">
   1.3 파이썬 처음 사용하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/01.04 파이썬 패키지 설치하기.html">
   1.4 파이썬 패키지 설치하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/01.05 데이터 분석용 파이썬 패키지 소개.html">
   1.5 데이터 분석용 파이썬 패키지 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/01.06 아이파이썬 및 주피터 설정.html">
   1.6 아이파이썬 및 주피터 설정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/01.07 구글 코랩 사용법.html">
   1.7 구글 코랩 사용법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.01 파이썬을 계산기로 사용하기.html">
   파이썬을 계산기로 사용하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.02 부동소수점 실수 자료형.html">
   부동소수점 실수 자료형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.03 파이썬으로 글자를 출력하기.html">
   파이썬으로 글자를 출력하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.04 파이썬의 문자열 형식화.html">
   파이썬의 문자열 형식화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.05 파이썬 조건문 기초.html">
   파이썬 조건문 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.06 파이썬 함수.html">
   파이썬 함수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.07 파이썬 for 반복문.html">
   파이썬 for 반복문
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.08 여러 개의 자료를 한 변수에 담기.html">
   여러 개의 자료를 한 변수에 담기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.09 파이썬에서 리스트 자료형 다루기.html">
   파이썬에서 리스트 자료형 다루기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.10 리스트와 반복문을 사용하여 계산하기.html">
   리스트와 반복문을 사용하여 계산하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.11 파이썬에서 딕셔너리 자료형 다루기.html">
   파이썬에서 딕셔너리 자료형 다루기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.12 파이썬 객체지향 프로그래밍.html">
   파이썬 객체지향 프로그래밍
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.13 파이썬 패키지 사용하기.html">
   파이썬 패키지 사용하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.14 파이썬의 자료형.html">
   파이썬의 자료형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.15 파이썬의 문자열 인코딩.html">
   파이썬의 문자열 인코딩
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/02.16 파이썬에서 날짜와 시간 다루기.html">
   파이썬에서 날짜와 시간 다루기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/03.01 NumPy 배열.html">
   NumPy 배열
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/03.02 배열의 생성과 변형.html">
   배열의 생성과 변형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/03.03 배열의 연산.html">
   배열의 연산
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/03.04 기술 통계.html">
   기술 통계
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/03.05 난수 발생과 카운팅.html">
   난수 발생과 카운팅
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.01 Pandas 패키지의 소개.html">
   Pandas 패키지의 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.02 데이터 입출력.html">
   데이터 입출력
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.03 데이터프레임 고급 인덱싱.html">
   데이터프레임 고급 인덱싱
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.04 데이터프레임의 데이터 조작.html">
   데이터프레임의 데이터 조작
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.05 데이터프레임 인덱스 조작.html">
   데이터프레임 인덱스 조작
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.06 데이터프레임 합성.html">
   데이터프레임 병합
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.07 피봇테이블과 그룹분석.html">
   피봇테이블과 그룹분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.08 시계열 자료 다루기.html">
   시계열 자료 다루기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/04.09 Dask 사용법 기초.html">
   Dask 사용법 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/05.01 시각화 패키지 Matplotlib 소개.html">
   시각화 패키지 Matplotlib 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/05.02 Matplotlib의 여러가지 플롯.html">
   Matplotlib의 여러가지 플롯
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/05.03 Matplotlib의 삼각 그리드 사용법.html">
   Matplotlib의 triangular grid 사용법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/05.04 Seaborn을 사용한 데이터 분포 시각화.html">
   Seaborn을 사용한 데이터 분포 시각화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01 python/05.05 Pandas의 시각화 기능.html">
   Pandas의 시각화 기능
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  수학 편
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/00.00 소개의 글.html">
   소개의 글
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/01.00 1장 수학 기호.html">
   1장 수학 기호
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/02.00 2장 넘파이(NumPy)로 공부하는 선형대수.html">
   2장 넘파이(NumPy)로 공부하는 선형대수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/03.00 3장 고급 선형대수.html">
   3장 고급 선형대수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/04.00 4장 심파이(SymPy)로 공부하는 미적분.html">
   4장 심파이(SymPy)로 공부하는 미적분
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/05.00 5장 사이파이(SciPy)로 공부하는 최적화.html">
   5장 사이파이(SciPy)로 공부하는 최적화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/06.00 6장 피지엠파이(pgmpy)로 공부하는 확률론.html">
   6장 피지엠파이(pgmpy)로 공부하는 확률론
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/07.00 7장 확률변수와 상관관계.html">
   7장 확률변수와 상관관계
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/08.00 8장 사이파이로 공부하는 확률분포.html">
   8장 사이파이로 공부하는 확률분포
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/09.00 9장 추정과 검정.html">
   9장 추정과 검정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02 mathematics/10.00 10장 엔트로피.html">
   10장 엔트로피
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  머신러닝 편
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01.01 데이터 분석의 소개.html">
   1.1 데이터 분석의 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.02 머신러닝용 파이썬 패키지.html">
   1.2 머신러닝용 파이썬 패키지
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.01 데이터 전처리 기초.html">
   2.1 데이터 전처리 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.02 범주형 데이터 처리.html">
   2.2 범주형 데이터 처리
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.01 NLTK 자연어 처리 패키지.html">
   NLTK 자연어 처리 패키지
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.02 KoNLPy 한국어 처리 패키지.html">
   KoNLPy 한국어 처리 패키지
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.03 Scikit-Learn의 문서 전처리 기능.html">
   Scikit-Learn의 문서 전처리 기능
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.04 soynlp.html">
   Soynlp 소개
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.01.05 확률론적 언어 모형.html">
   확률론적 언어 모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.01 이미지 처리 기초.html">
   이미지 처리 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.02 이미지 필터링.html">
   이미지 필터링
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.03 이미지 컨투어.html">
   이미지 컨투어
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.04 이미지 변환.html">
   이미지 변환
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02.05 이미지 특징 추출.html">
   이미지 특징 추출
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.03.01 사운드 프로세싱 기초.html">
   사운드 프로세싱 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.03.02 푸리에 변환과 스펙트럼.html">
   푸리에 변환과 스펙트럼
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.04.01 지리 정보 데이터 처리.html">
   지리 정보 데이터 처리
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.04.02 지오코딩.html">
   Geocoding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.01 회귀분석 예제.html">
   4.1 회귀분석 예제
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.02 선형회귀분석의 기초.html">
   4.2 선형회귀분석의 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.03 스케일링.html">
   4.3 스케일링
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.04 범주형 독립변수.html">
   4.4 범주형 독립변수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04.05 부분회귀.html">
   4.5 부분회귀
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.01 확률론적 선형 회귀모형.html">
   5.1 확률론적 선형 회귀모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.02 회귀분석의 기하학.html">
   5.2 회귀분석의 기하학
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.03 레버리지와 아웃라이어.html">
   5.3 레버리지와 아웃라이어
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05.04 분산 분석과 모형 성능.html">
   5.4 분산 분석과 모형 성능
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 모형 진단과 수정.html">
   6.1 모형 진단과 수정
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 모형 진단과 수정.html#id2">
   잔차 정규성
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 모형 진단과 수정.html#id3">
   잔차와 독립 변수의 관계
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 모형 진단과 수정.html#id4">
   이분산성
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.01 모형 진단과 수정.html#id5">
   자기 상관 계수
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.02 기저함수 모형과 과최적화.html">
   6.2 기저함수 모형과 과최적화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.03 교차검증.html">
   6.3 교차검증
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.04 다중공선성과 변수 선택.html">
   6.4 다중공선성과 변수 선택
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.04 다중공선성과 변수 선택.html#vif">
   VIF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.04 다중공선성과 변수 선택.html#id2">
   보스턴 집값 예측 문제에 응용
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06.05 정규화 선형회귀.html">
   6.5 정규화 선형회귀
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07.01 추천 시스템.html">
   13.1 추천 시스템
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.01 분류용 예제 데이터.html">
   5.1 분류용 예제 데이터
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 분류용 가상 데이터 생성.html">
   5.2 분류용 가상 데이터 생성
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 분류용 가상 데이터 생성.html#make-blobs">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_blobs
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 분류용 가상 데이터 생성.html#make-moons">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_moons
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.02 분류용 가상 데이터 생성.html#make-gaussian-quantiles">
   <code class="docutils literal notranslate">
    <span class="pre">
     make_gaussian_quantiles
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.03 분류모형.html">
   5.3 분류모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.04 분류 성능평가.html">
   5.4 분류 성능평가
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10.01 로지스틱 회귀분석.html">
   6.1 로지스틱 회귀분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.01 선형판별분석법과 이차판별분석법.html">
   7.1 선형판별분석법과 이차판별분석법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.02 나이브베이즈 분류모형.html">
   7.2 나이브베이즈 분류모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11.03 감성 분석.html">
   감성 분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.01 의사결정나무.html">
   8.1 의사결정나무
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.02 모형 결합.html">
   12.02 모형 결합
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12.03 부스팅 방법.html">
   부스팅 방법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13.02 서포트 벡터 머신.html">
   서포트 벡터 머신
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13.03 커널 서포트 벡터 머신.html">
   커널 서포트 벡터 머신
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.01 모형 최적화.html">
   모형 최적화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.02 비대칭 데이터 문제.html">
   비대칭 데이터 문제
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.03 특징 선택.html">
   특징 선택
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14.04 대규모 데이터 학습.html">
   대규모 데이터 학습
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.01 군집화.html">
   군집화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.02 K-평균 군집화.html">
   K-평균 군집화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.03 디비스캔 군집화.html">
   디비스캔 군집화
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   계층적 군집화
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16.05 Affinity Propagation.html">
   Affinity Propagation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.01 그래프 이론 기초.html">
   그래프 이론 기초
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.02 그래프 확률모형.html">
   그래프 확률모형
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17.03 네트워크 추론.html">
   네트워크 추론
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18.01 가우시안 혼합모형과 EM 방법.html">
   가우시안 혼합모형과 EM 방법
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18.02 변분법적 추론.html">
   변분법적 추론
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19.01 몬테카를로 베이지안 분석.html">
   몬테카를로 베이지안 분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19.02 베이지안 회귀 분석 예제.html">
   베이지안 회귀 분석 예제
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="20.01 히든 마코프 모형.html">
   히든 마코프 모형
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/03 machine learning/16.04 계층적 군집화.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/03 machine learning/16.04 계층적 군집화.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/03 machine learning/16.04 계층적 군집화.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   군집간의 거리 측정
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   비계층적 거리 측정법
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#centroid">
     중심(centroid)거리
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#single">
     단일(single)거리
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#complete">
     완전(complete)거리
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#average">
     평균(average)거리
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   계층적 거리 측정법
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#median">
     중앙값(median)거리
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#weighted">
     가중(weighted)거리
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ward">
     와드(Ward)거리
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scipy">
   scipy의 계층적 군집화
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>계층적 군집화<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>**계층적 군집화(hierachical clustering)**는 여러개의 군집 중에서 가장 유사도가 높은 혹은 거리가 가까운 군집 두 개를 선택하여 하나로 합치면서 군집 개수를 줄여 가는 방법을 말한다. **합체 군집화(agglomerative clustering)**라고도 한다. 가장 처음에는 모든 군집이 하나의 데이터만을 가진다. 따라서 최초에는 데이터 개수만큼 군집이 존재하지만 군집을 합치면서 최종적으로 하나의 군집만 남게 된다.</p>
<div class="section" id="id2">
<h2>군집간의 거리 측정<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>계측정 군집화를 하려면 우선 모든 군집 간에 거리를 측정해야 한다. 군집 간의 거리를 측정하는 방법에는 계층적 방법에 의존하지 않는 비계층적 방법과 이미 이전 단계에서 계층적 방법으로 군집이 합쳐진 적인 있다는 가정을 하는 계층적 방법 두 가지가 있다.</p>
</div>
<div class="section" id="id3">
<h2>비계층적 거리 측정법<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>비계층적 거리측정법은 계층적 군집화가 아니더라도 모든 경우에 사용할 수 있는 거리 측정 방법이다. 중심거리, 단일거리, 완전거리, 평균거리 등이 있다. 다음에 설명할 계층적 거리측정법에 비해 계산량이 많은 단점이 있다.</p>
<div class="section" id="centroid">
<h3>중심(centroid)거리<a class="headerlink" href="#centroid" title="Permalink to this headline">¶</a></h3>
<p>두 군집의 중심점(centroid)를 정의한 다음 두 중심점의 거리를 군집간의 거리로 정의한다.</p>
<div class="math notranslate nohighlight">
\[
d(u,v) = \|c_u - c_v\|_2
\]</div>
<p>여기에서 <span class="math notranslate nohighlight">\(d(u,v)\)</span>는 군집 <span class="math notranslate nohighlight">\(u\)</span>와 군집 <span class="math notranslate nohighlight">\(v\)</span> 사이의 거리를 뜻한다. 또한 <span class="math notranslate nohighlight">\(c_u\)</span>와 <span class="math notranslate nohighlight">\(c_v\)</span>는 각각 두 군집 <span class="math notranslate nohighlight">\(u\)</span>와 <span class="math notranslate nohighlight">\(v\)</span>의 중심점이다. 군집의 중심점은 그 클러스에 포함된 모든 데이터의 평균을 사용한다.</p>
<div class="math notranslate nohighlight">
\[
c_u = \dfrac{1}{|u|}\sum_i u_i
\]</div>
<p>이 식에서 <span class="math notranslate nohighlight">\(|\cdot|\)</span> 기호는 군집의 원소의 갯수를 말한다.</p>
</div>
<div class="section" id="single">
<h3>단일(single)거리<a class="headerlink" href="#single" title="Permalink to this headline">¶</a></h3>
<p>군집 <span class="math notranslate nohighlight">\(u\)</span>의 모든 데이터 <span class="math notranslate nohighlight">\(u_i\)</span>와 군집 <span class="math notranslate nohighlight">\(v\)</span>의 모든 데이터 <span class="math notranslate nohighlight">\(v_j\)</span>의 모든 조합에 대해 데이터 사이의 거리 <span class="math notranslate nohighlight">\(d(u_i,v_j)\)</span>를 측정해서 가장 작은 값을 구한다. 최소 거리(Nearest Point) 방법이라고도 한다.</p>
<div class="math notranslate nohighlight">
\[
d(u,v) = \min(d(u_i,v_j))
\]</div>
</div>
<div class="section" id="complete">
<h3>완전(complete)거리<a class="headerlink" href="#complete" title="Permalink to this headline">¶</a></h3>
<p>군집 <span class="math notranslate nohighlight">\(u\)</span>의 모든 데이터 <span class="math notranslate nohighlight">\(u_i\)</span>와 군집 <span class="math notranslate nohighlight">\(v\)</span>의 모든 데이터 <span class="math notranslate nohighlight">\(v_j\)</span>의 모든 조합에 대해 데이터 사이의 거리 <span class="math notranslate nohighlight">\(d(u_i,v_j)\)</span>를 측정해서 가장 큰 값을 구한다. 최장 거리(Farthest Point) 방법이라고도 한다.</p>
<div class="math notranslate nohighlight">
\[
d(u,v) = \max(d(u_i,v_j))
\]</div>
</div>
<div class="section" id="average">
<h3>평균(average)거리<a class="headerlink" href="#average" title="Permalink to this headline">¶</a></h3>
<p>군집 <span class="math notranslate nohighlight">\(u\)</span>의 모든 데이터 <span class="math notranslate nohighlight">\(u_i\)</span>와 군집 <span class="math notranslate nohighlight">\(v\)</span>의 모든 데이터 <span class="math notranslate nohighlight">\(v_j\)</span>의 모든 조합에 대해 데이터 사이의 거리 <span class="math notranslate nohighlight">\(d(u_i,v_j)\)</span>를 측정해서 평균을 구한다. <span class="math notranslate nohighlight">\(|u|\)</span>와 <span class="math notranslate nohighlight">\(|v|\)</span>는 각각 두 군집의 원소의 갯수를 뜻한다.</p>
<div class="math notranslate nohighlight">
\[
   d(u,v) = \sum_{i,j} \frac{d(u_i, v_j)}{|u||v|}
\]</div>
</div>
</div>
<div class="section" id="id4">
<h2>계층적 거리 측정법<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>계층적 거리 측정법은 계층적 군집화에서만 사용할 수 있는 방법이다. 즉, 이전 단계에서 이미 어떤 두 개의 군집이 하나로 합쳐진 적이 있다고 가정하여 이 정보를 사용하는 측정법이다. 비계층적 거리 측정법에 비해 계산량이 적어 효율적이다.</p>
<div class="section" id="median">
<h3>중앙값(median)거리<a class="headerlink" href="#median" title="Permalink to this headline">¶</a></h3>
<p>이 방법은 중심거리 방법의 변형이다. 중심거리 방법처럼 군집의 중심점의 거리를 군집간의 거리라고 한다. 하지만 군집의 중심점을 계산하는 방법이 다르다. 만약 군집 <span class="math notranslate nohighlight">\(u\)</span>가 군집 <span class="math notranslate nohighlight">\(s\)</span>와 군집 <span class="math notranslate nohighlight">\(t\)</span>가 결합하여 생겼다면</p>
<div class="math notranslate nohighlight">
\[ 
u \leftarrow s + t 
\]</div>
<p>군집 <span class="math notranslate nohighlight">\(u\)</span>의 중심점은 새로 계산하지 않고 원래 군집의 두 군집의 중심점의 평균을 사용한다.</p>
<div class="math notranslate nohighlight">
\[
c_u = \dfrac{1}{2}(c_s + s_t)
\]</div>
<p>따라서 해당 군집의 모든 데이터를 평균하여 중심점을 구하는 것 보다 계산이 빠르다.</p>
</div>
<div class="section" id="weighted">
<h3>가중(weighted)거리<a class="headerlink" href="#weighted" title="Permalink to this headline">¶</a></h3>
<p>가중거리를 사용하려면 원래 어떤 두 개의 군집이 합쳐져서 하나의 군집이 만들어졌는지 알아야 한다. 만약 군집 <span class="math notranslate nohighlight">\(u\)</span>가 군집 <span class="math notranslate nohighlight">\(s\)</span>와 군집 <span class="math notranslate nohighlight">\(t\)</span>가 결합하여 생겼다면</p>
<div class="math notranslate nohighlight">
\[ 
u \leftarrow s + t 
\]</div>
<p>이 군집 <span class="math notranslate nohighlight">\(u\)</span>와 다른 군집 <span class="math notranslate nohighlight">\(v\)</span> 사이의 거리는 군집 <span class="math notranslate nohighlight">\(u\)</span>를 구성하는 원래 군집 <span class="math notranslate nohighlight">\(s\)</span>, <span class="math notranslate nohighlight">\(t\)</span>와 <span class="math notranslate nohighlight">\(v\)</span> 사이의 두 거리의 평균을 사용한다.</p>
<div class="math notranslate nohighlight">
\[
   d(u,v) = \dfrac{1}{2}(d(s,v) + d(t,v))
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> tikzmagic
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">tikz</span> -p kotex,pgfplots,amsmath -l arrows.meta,calc,positioning,shapes -s 2000,1200 -f png

\coordinate (left bottom) at (1, 1);
\coordinate (right top) at (10, 5);
\fill[white, use as bounding box] (left bottom) rectangle (right top);
\draw[help lines, white] (left bottom) grid (right top);
\tikzset{
    &gt;=stealth,font={\ttfamily\normalsize},
}
\tikzset{node/.style={draw, ellipse, minimum width=1.5cm, minimum height=1cm}}

\node[node] at (3,3) (v) {$v$};
\node[node] at (7,3.8) (t) {$t$};
\node[node] at (7,2.2) (s) {$s$};
\node[node, minimum width=3cm,, minimum height=3.8cm] at (7,3) (u) {$u$};
\draw[&lt;-&gt;] (v) -- (u);
\draw[&lt;-&gt;] (v) -- (s);
\draw[&lt;-&gt;] (v) -- (t);
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/16.04 계층적 군집화_15_0.png" src="../_images/16.04 계층적 군집화_15_0.png" />
</div>
</div>
</div>
<div class="section" id="ward">
<h3>와드(Ward)거리<a class="headerlink" href="#ward" title="Permalink to this headline">¶</a></h3>
<p>와드거리는 가중거리방법의 변형이다. 만약 군집 <span class="math notranslate nohighlight">\(u\)</span>가 군집 <span class="math notranslate nohighlight">\(s\)</span>와 군집 <span class="math notranslate nohighlight">\(t\)</span>가 결합하여 생겼다면</p>
<div class="math notranslate nohighlight">
\[ 
u \leftarrow s + t 
\]</div>
<p>이 군집 <span class="math notranslate nohighlight">\(u\)</span>와 다른 군집 <span class="math notranslate nohighlight">\(v\)</span> 사이의 거리를 구하는데 있어서 군집 <span class="math notranslate nohighlight">\(u\)</span>를 구성하는 원래 군집 <span class="math notranslate nohighlight">\(s\)</span>, <span class="math notranslate nohighlight">\(t\)</span>와 <span class="math notranslate nohighlight">\(v\)</span> 사이의 거리를 사용하는 것은 가중거리 방법과 같지만 원래의 두 군집 <span class="math notranslate nohighlight">\(s\)</span>, <span class="math notranslate nohighlight">\(t\)</span>가 너무 가까우면 <span class="math notranslate nohighlight">\(v\)</span>와의 거리가 더 먼것으로 인식한다.</p>
<div class="math notranslate nohighlight">
\[
   d(u,v) = \sqrt{\frac{|v|+|s|}{|v|+|s|+|t|}d(v,s)^2 + \frac{|v|+|t|}{|v|+|s|+|t|}d(v,t)^2 - \frac{|v|}{|v|+|s|+|t|}d(s,t)^2}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">tikz</span> -p kotex,pgfplots,amsmath -l arrows.meta,calc,positioning,shapes -s 2000,1200 -f png

\coordinate (left bottom) at (-2, 0);
\coordinate (right top) at (10, 6);
\fill[white, use as bounding box] (left bottom) rectangle (right top);
\draw[help lines, white] (left bottom) grid (right top);
\tikzset{
    &gt;=stealth,font={\ttfamily\normalsize},
}
\tikzset{node/.style={draw, ellipse, minimum width=1.5cm, minimum height=1cm}}

\node[node] at (4,3) (v) {$v$};
\node[node] at (8.4,3.8) (s1) {$s_1$};
\node[node] at (8.4,2.2) (t1) {$t_1$};
\node[node, minimum width=3cm,, minimum height=3.8cm] at (8.4,3) (u1) {\hspace{-4em}$u_1$};
\node[node] at (0,4.5) (s2) {$s_2$};
\node[node] at (0,1.5) (t2) {$t_2$};
\node[node, minimum width=3cm,, minimum height=4.8cm] at (0,3) (u2) {\hspace{4em}$u_2$};
\draw[&lt;-&gt;] (v) -- (u1);
\draw[&lt;-&gt;] (v) -- (s1);
\draw[&lt;-&gt;] (v) -- (t1);
\draw[&lt;-&gt;] (s1) -- (t1);
\draw[&lt;-&gt;] (v) -- (u2);
\draw[&lt;-&gt;] (v) -- (s2);
\draw[&lt;-&gt;] (v) -- (t2);
\draw[&lt;-&gt;] (s2) -- (t2);
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/16.04 계층적 군집화_17_0.png" src="../_images/16.04 계층적 군집화_17_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="scipy">
<h2>scipy의 계층적 군집화<a class="headerlink" href="#scipy" title="Permalink to this headline">¶</a></h2>
<p>파이썬으로 계층적 군집화를 하려면 사이파이 패키지의 <code class="docutils literal notranslate"><span class="pre">linkage</span></code> 명령을 사용하거나 사이킷런 패키지의 <code class="docutils literal notranslate"><span class="pre">AgglomerativeClustering</span></code> 클래스를 사용한다. 각각 장단점이 있는데 사이파이 패키지는 군집화 결과를 트리 형태로 시각화해주는 <code class="docutils literal notranslate"><span class="pre">dendrogram</span></code> 명령도 지원한다.</p>
<p>MNIST digit 이미지 중 20개의 이미지를 무작위로 골라 계층적 군집화를 적용해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>

<span class="n">digits</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">()</span>
<span class="n">n_image</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="o">.</span><span class="n">images</span><span class="p">)),</span> <span class="n">n_image</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">images</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_image</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_image</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">bone</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/16.04 계층적 군집화_21_0.png" src="../_images/16.04 계층적 군집화_21_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">linkage</span><span class="p">,</span> <span class="n">dendrogram</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;ward&#39;</span><span class="p">)</span>
<span class="n">Z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 3.        , 18.        , 23.51595203,  2.        ],
       [13.        , 19.        , 25.27844932,  2.        ],
       [ 1.        , 14.        , 28.67054237,  2.        ],
       [17.        , 21.        , 31.04298096,  3.        ],
       [ 4.        ,  7.        , 31.51190251,  2.        ],
       [ 6.        ,  8.        , 32.54228019,  2.        ],
       [ 9.        , 10.        , 33.36165464,  2.        ],
       [ 0.        , 24.        , 34.51086785,  3.        ],
       [ 2.        , 22.        , 37.03151811,  3.        ],
       [11.        , 26.        , 43.25505751,  3.        ],
       [12.        , 15.        , 45.31004304,  2.        ],
       [16.        , 20.        , 45.36151085,  3.        ],
       [ 5.        , 27.        , 53.54437412,  4.        ],
       [30.        , 32.        , 56.6892112 ,  6.        ],
       [25.        , 29.        , 60.16809786,  5.        ],
       [28.        , 34.        , 66.61618922,  8.        ],
       [31.        , 33.        , 70.35228813,  9.        ],
       [23.        , 36.        , 80.11172754, 12.        ],
       [35.        , 37.        , 93.57946712, 20.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.offsetbox</span> <span class="kn">import</span> <span class="n">OffsetImage</span><span class="p">,</span> <span class="n">AnnotationBbox</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>

<span class="n">ddata</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

<span class="n">dcoord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ddata</span><span class="p">[</span><span class="s2">&quot;dcoord&quot;</span><span class="p">])</span>
<span class="n">icoord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ddata</span><span class="p">[</span><span class="s2">&quot;icoord&quot;</span><span class="p">])</span>
<span class="n">leaves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ddata</span><span class="p">[</span><span class="s2">&quot;leaves&quot;</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">dcoord</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">dcoord</span> <span class="o">=</span> <span class="n">dcoord</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">icoord</span> <span class="o">=</span> <span class="n">icoord</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">Z</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">label_pos</span> <span class="o">=</span> <span class="n">icoord</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="n">idx</span><span class="p">][:</span><span class="mi">20</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">imagebox</span> <span class="o">=</span> <span class="n">OffsetImage</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">bone_r</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;bilinear&quot;</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">AnnotationBbox</span><span class="p">(</span><span class="n">imagebox</span><span class="p">,</span> <span class="p">(</span><span class="n">label_pos</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>  <span class="n">box_alignment</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">),</span> 
                        <span class="n">bboxprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;edgecolor&quot;</span> <span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">})</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/16.04 계층적 군집화_23_0.png" src="../_images/16.04 계층적 군집화_23_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./03 machine learning"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="16.03 디비스캔 군집화.html" title="previous page">디비스캔 군집화</a>
    <a class='right-next' id="next-link" href="16.05 Affinity Propagation.html" title="next page">Affinity Propagation</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By 김도형<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>